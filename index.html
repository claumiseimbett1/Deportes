        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ P√°gina cargada, iniciando sistema de actualizaci√≥n autom√°tica...');
            console.log('üìã Tu Google Sheet: "RECORD MASTER"');
            console.log('üïê √öltima modificaci√≥n detectada: hace 1 hora');
            
            // Agregar bot√≥n de prueba temporal
            addTestButton();
            
            startAutoReload();
        });

        // Funci√≥n para agregar bot√≥n de prueba (temporal)
        function addTestButton() {
            const testButton = document.createElement('button');
            testButton.innerHTML = 'üß™ Probar conexi√≥n';
            testButton.style.cssText = `
                position: fixed;
                bottom: 20px;
                right: 20px;
                z-index: 9999;
                padding: 10px 20px;
                background: #ff9800;
                color: white;
                border: none;
                border-radius: 25px;
                cursor: pointer;
                font-weight: 600;
                box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            `;
            testButton.onclick = function() {
                console.log('üß™ Iniciando prueba<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IV Championship Master - AquaTEN</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: #ffffff;
            color: #0b1039;
            line-height: 1.6;
        }

        /* Animaciones */
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .loading {
            animation: pulse 2s infinite;
        }

        /* Header */
        .header {
            background-color: #ffffff;
            box-shadow: 0 2px 15px rgba(11, 16, 57, 0.1);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 15px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo-box {
            height: 60px;
            display: flex;
            align-items: center;
        }

        .logo-box img {
            height: 100%;
            width: auto;
        }

        /* Status indicator */
        .status-indicator {
            position: fixed;
            top: 100px;
            right: 20px;
            z-index: 9999;
            padding: 10px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .status-loading {
            background: #ffa726;
            color: white;
        }

        .status-success {
            background: #4caf50;
            color: white;
        }

        .status-error {
            background: #f44336;
            color: white;
        }

        /* Video Hero Section */
        .video-hero {
            margin-top: 90px;
            position: relative;
            width: 100%;
            height: 70vh;
            min-height: 500px;
            overflow: hidden;
            background-color: #0b1039;
        }

        .video-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .video-container video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border: none;
        }

        .video-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(11, 16, 57, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .hero-content {
            text-align: center;
            z-index: 1;
            padding: 0 20px;
        }

        .hero-content h1 {
            font-size: 4em;
            color: #ffffff;
            margin-bottom: 20px;
            font-weight: 700;
            letter-spacing: -1px;
        }

        .hero-content .subtitle {
            font-size: 1.5em;
            color: #f0f6ff;
            font-weight: 300;
        }

        /* Info & Contact Section */
        .info-section, .contact-section {
            padding: 100px 20px;
            background-color: #ffffff;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .section-title {
            text-align: center;
            font-size: 2.8em;
            color: #0b1039;
            margin-bottom: 60px;
            font-weight: 700;
        }

        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 40px;
            margin-bottom: 60px;
        }
        
        .contact-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            justify-content: center;
            max-width: 800px;
            margin: 0 auto;
        }

        .info-card, .contact-card-link {
            background: #ffffff;
            border: 1px solid #f0f6ff;
            border-radius: 20px;
            padding: 50px 30px;
            text-align: center;
            box-shadow: 0 5px 25px rgba(11, 16, 57, 0.08);
            transition: all 0.3s ease;
            text-decoration: none;
            color: inherit;
        }

        .info-card:hover, .contact-card-link:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 40px rgba(11, 16, 57, 0.15);
            border-color: #00ADEF;
        }

        /* Iconos SVG minimalistas */
        .sticker-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto 25px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .sticker-icon svg {
            width: 100%;
            height: 100%;
        }

        .info-card h3, .contact-card-link h3 {
            color: #0b1039;
            font-size: 1.8em;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .info-card p, .contact-card-link p {
            color: #a5a5a5;
            font-size: 1.1em;
            line-height: 1.8;
        }

        /* Results Section */
        .results-section {
            padding: 100px 20px;
            background: #f0f6ff;
        }

        .results-container {
            background: #ffffff;
            border-radius: 20px;
            padding: 50px;
            box-shadow: 0 10px 40px rgba(11, 16, 57, 0.1);
            border: 2px solid #f0f6ff;
        }

        /* Pesta√±as de Resultados */
        .tabs {
            display: flex;
            margin-bottom: 30px;
            border-bottom: 2px solid #f0f6ff;
            flex-wrap: wrap;
            justify-content: center;
        }

        .tab-button {
            padding: 15px 30px;
            cursor: pointer;
            background-color: transparent;
            border: none;
            border-bottom: 3px solid transparent;
            color: #0b1039;
            font-size: 1.1em;
            transition: all 0.3s ease;
            margin: 0 10px;
            border-radius: 10px 10px 0 0;
            font-weight: 500;
        }

        .tab-button:hover {
            color: #00ADEF;
            background-color: rgba(0, 173, 239, 0.05);
        }

        .tab-button.active {
            color: #00ADEF;
            border-bottom: 3px solid #00ADEF;
            background-color: #f0f6ff;
            font-weight: 600;
        }

        .tab-content {
            display: none;
            padding: 30px 0;
        }

        .tab-content.active {
            display: block;
        }

        .tab-content h3 {
            color: #0b1039;
            margin-bottom: 30px;
            text-align: center;
            font-size: 1.8em;
            font-weight: 600;
        }

        /* Indicador de √∫ltima actualizaci√≥n */
        .last-update {
            text-align: center;
            margin-bottom: 20px;
            color: #a5a5a5;
            font-size: 0.9em;
        }

        .last-update .time {
            color: #00ADEF;
            font-weight: 600;
        }

        /* Tabla de Resultados */
        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background-color: #ffffff;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 25px rgba(11, 16, 57, 0.08);
        }

        .results-table th, .results-table td {
            padding: 15px 20px;
            text-align: left;
            border-bottom: 1px solid #f0f6ff;
        }

        .results-table th {
            background-color: #0b1039;
            color: #ffffff;
            font-weight: 600;
            font-size: 1em;
        }

        .results-table tr:nth-child(even) td {
            background-color: #fafcff;
        }

        .results-table tr:hover td {
            background-color: #f0f6ff;
            transition: background-color 0.3s ease;
        }

        .results-table .rank {
            font-weight: bold;
            color: #0b1039;
            text-align: center;
        }

        .results-table .time {
            font-family: 'Courier New', Courier, monospace;
            font-weight: bold;
            color: #0b1039;
            text-align: center;
        }

        .results-table .points {
            font-weight: bold;
            color: #00ADEF;
            text-align: center;
        }

        /* Categor√≠a headers - ESTILO UNIFORME PARA TODAS LAS CATEGOR√çAS */
        .category-header {
            background: linear-gradient(135deg, #0b1039 0%, #00ADEF 100%) !important;
            color: #ffffff !important;
            text-align: center;
            font-size: 1.1em;
            font-weight: bold;
        }

        .category-header td {
            border-bottom: 2px solid #00ADEF !important;
            color: #ffffff !important;
        }

        /* Loading state para la tabla */
        .results-table.loading {
            opacity: 0.7;
        }

        .loading-row {
            text-align: center;
            color: #a5a5a5;
            font-style: italic;
        }

        /* Sponsors Section */
        .sponsors-section {
            padding: 100px 20px;
            background: #ffffff;
        }

        .sponsors-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-top: 50px;
        }

        .sponsor-card {
            background: #ffffff;
            border: 2px solid #f0f6ff;
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            text-decoration: none;
            display: block;
        }

        .sponsor-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(11, 16, 57, 0.15);
            border-color: #00ADEF;
        }

        .sponsor-logo {
            height: 80px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .sponsor-logo img {
            max-height: 100%;
            max-width: 100%;
            object-fit: contain;
            filter: grayscale(100%);
            transition: filter 0.3s ease;
        }

        .sponsor-card:hover .sponsor-logo img {
            filter: grayscale(0%);
        }

        .sponsor-name {
            font-size: 1.2em;
            color: #0b1039;
            font-weight: 600;
        }

        /* CTA Section */
        .cta-section {
            padding: 100px 20px;
            background: linear-gradient(135deg, #0b1039 0%, #0b5079 100%);
            text-align: center;
            position: relative;
        }

        .cta-section h2 {
            color: #ffffff;
            font-size: 3em;
            margin-bottom: 25px;
            font-weight: 700;
        }

        .cta-section p {
            color: #f0f6ff;
            font-size: 1.3em;
            margin-bottom: 40px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .cta-button {
            display: inline-block;
            background: #00ADEF;
            color: #ffffff;
            padding: 18px 50px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            font-size: 1.2em;
            transition: all 0.3s ease;
            box-shadow: 0 5px 20px rgba(0, 173, 239, 0.3);
        }

        .cta-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 30px rgba(0, 173, 239, 0.5);
            background: #0099d8;
        }

        /* Footer */
        .footer {
            background-color: #0b1039;
            color: #ffffff;
            padding: 50px 20px;
            text-align: center;
        }

        .footer p {
            margin-bottom: 10px;
            color: #f0f6ff;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .hero-content h1 {
                font-size: 2.5em;
            }

            .hero-content .subtitle {
                font-size: 1.2em;
            }

            .section-title {
                font-size: 2em;
            }

            .nav-container {
                padding: 15px 20px;
            }

            .logo-box {
                height: 45px;
            }

            .video-hero {
                height: 60vh;
                min-height: 400px;
            }

            .info-section, .results-section, .sponsors-section, .cta-section, .contact-section {
                padding: 60px 20px;
            }

            .sponsors-grid {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 25px;
            }

            .tabs {
                flex-direction: column;
            }

            .tab-button {
                width: 100%;
                text-align: center;
                margin: 5px 0;
                border-radius: 8px;
            }

            .tab-button.active {
                border-left: 3px solid #00ADEF;
                border-bottom: 1px solid #f0f6ff;
            }

            .results-table th, .results-table td {
                padding: 10px 12px;
                font-size: 0.9em;
            }

            .results-table thead {
                display: none;
            }

            .results-table tr {
                display: block;
                margin-bottom: 15px;
                border: 1px solid #f0f6ff;
                border-radius: 8px;
                background-color: #ffffff;
            }

            .results-table td {
                display: block;
                text-align: right;
                padding-left: 50%;
                position: relative;
            }

            .results-table td::before {
                content: attr(data-label);
                position: absolute;
                left: 10px;
                font-weight: bold;
                text-align: left;
                color: #0b1039;
            }

            .cards-grid, .contact-grid {
                grid-template-columns: 1fr;
                gap: 25px;
            }

            .status-indicator {
                position: relative;
                top: auto;
                right: auto;
                margin: 10px auto;
                display: inline-block;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <nav class="nav-container">
            <div class="logo-box">
                <img src="img/LogoChampion2025.png" alt="Logo IV Championship Master">
            </div>
            <div class="logo-box">
                <img src="img/LogoClubes.png" alt="Logo Clubes">
            </div>
        </nav>
    </header>

    <!-- Status Indicator -->
    <div id="statusIndicator" class="status-indicator status-loading">
        üîÑ Cargando resultados...
    </div>

    <!-- Video Hero Section -->
    <section class="video-hero">
        <div class="video-container">
            <video autoplay muted loop playsinline src="video/promocional.mp4">
                Tu navegador no soporta la etiqueta de video.
            </video>
        </div>
        <div class="video-overlay">
            <div class="hero-content">
                <h1>IV Championship Master</h1>
                <p class="subtitle">Competencia de Nataci√≥n Master</p>
            </div>
        </div>
    </section>

    <!-- Info Section -->
    <section class="info-section">
        <div class="container">
            <h2 class="section-title">Informaci√≥n del Evento</h2>
            <div class="cards-grid">
                <div class="info-card">
                    <div class="sticker-icon">
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2Z" stroke="#00ADEF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M12 6V12L16 14" stroke="#00ADEF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                    </div>
                    <h3>Categor√≠as</h3>
                    <p>Competencias para todas las categor√≠as master desde 25+ hasta 80+ a√±os</p>
                </div>
                <div class="info-card">
                    <div class="sticker-icon">
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="4" width="18" height="18" rx="2" ry="2" stroke="#0b5079" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><line x1="16" y1="2" x2="16" y2="6" stroke="#0b5079" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><line x1="8" y1="2" x2="8" y2="6" stroke="#0b5079" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><line x1="3" y1="10" x2="21" y2="10" stroke="#0b5079" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                    </div>
                    <h3>Fecha</h3>
                    <p>Del 15 al 17 de marzo de 2024 en nuestras instalaciones</p>
                </div>
                <div class="info-card">
                    <div class="sticker-icon">
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 8V12L14.5 14.5" stroke="#00ADEF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M20.9998 12C20.9998 16.9706 16.9704 21 11.9998 21C7.02926 21 2.99982 16.9706 2.99982 12C2.99982 7.02944 7.02926 3 11.9998 3C13.8837 3 15.6265 3.58628 17.0615 4.61538" stroke="#00ADEF" stroke-width="2" stroke-linecap="round"/><path d="M18 5.5L21 2.5M21 2.5L18 2.5M21 2.5V5.5" stroke="#00ADEF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                    </div>
                    <h3>Premios</h3>
                    <p>Medallas y trofeos para los primeros lugares de cada categor√≠a</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Results Section -->
    <section class="results-section">
        <div class="container">
            <h2 class="section-title">Resultados en Tiempo Real</h2>
            <div class="results-container">
                <div class="last-update">
                    √öltima actualizaci√≥n: <span class="time" id="lastUpdateTime">Cargando...</span>
                </div>
                
                <div class="tabs">
                    <button class="tab-button active" onclick="openTab(event, '1500m-libre')">1500M Libre</button>
                    <button class="tab-button" onclick="openTab(event, 'records-master')">Records Master</button>
                </div>

                <!-- Pesta√±a 1500M Libre -->
                <div id="1500m-libre" class="tab-content active">
                    <h3>üèä‚Äç‚ôÄÔ∏è 1500M Libre Femenino - Resultados Oficiales</h3>
                    <table class="results-table" id="resultsTable">
                        <thead>
                            <tr>
                                <th>Pos.</th>
                                <th>Nadadora</th>
                                <th>Equipo</th>
                                <th>Edad</th>
                                <th>Categor√≠a</th>
                                <th>Tiempo Final</th>
                                <th>Puntos</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="loading-row">
                                <td colspan="7" style="text-align: center; padding: 40px; color: #a5a5a5;">
                                    üîÑ Cargando datos desde Google Sheets...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Pesta√±a Records Master -->
                <div id="records-master" class="tab-content">
                    <h3>üèÜ Records de Categor√≠a Master Masculino</h3>
                    <table class="results-table">
                        <thead>
                            <tr>
                                <th>Distancia</th>
                                <th>Atleta</th>
                                <th>Equipo</th>
                                <th>Categor√≠a</th>
                                <th>Tiempo Record</th>
                                <th>Fecha</th>
                                <th>Competencia</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="category-header">
                                <td colspan="7">50M LIBRE</td>
                            </tr>
                            <tr>
                                <td data-label="Distancia">50m Libre</td>
                                <td data-label="Atleta">LUIS SEBASTIAN PAEZ</td>
                                <td data-label="Equipo">NNG</td>
                                <td data-label="Categor√≠a">Mayores</td>
                                <td data-label="Tiempo Record" class="time">00:24.70</td>
                                <td data-label="Fecha">12/4/2020</td>
                                <td data-label="Competencia">NACIONAL INTERCLUBES</td>
                            </tr>
                            <tr>
                                <td data-label="Distancia">50m Libre</td>
                                <td data-label="Atleta">Julian arbelaez</td>
                                <td data-label="Equipo">DELFINES</td>
                                <td data-label="Categor√≠a">Master A</td>
                                <td data-label="Tiempo Record" class="time">00:30.97</td>
                                <td data-label="Fecha">12/13/2020</td>
                                <td data-label="Competencia">II CHAMPIONSHIP MASTER</td>
                            </tr>
                            <tr>
                                <td data-label="Distancia">50m Libre</td>
                                <td data-label="Atleta">HERNANDO ALBERTO URREA SERNA</td>
                                <td data-label="Equipo">DELFINES</td>
                                <td data-label="Categor√≠a">Master B</td>
                                <td data-label="Tiempo Record" class="time">00:32.44</td>
                                <td data-label="Fecha">6/2/2019</td>
                                <td data-label="Competencia">TORNEO FREE STYLE</td>
                            </tr>
                            <tr>
                                <td data-label="Distancia">50m Libre</td>
                                <td data-label="Atleta">RAFAEL RIVERO BLANCO</td>
                                <td data-label="Equipo">NNG</td>
                                <td data-label="Categor√≠a">Master C</td>
                                <td data-label="Tiempo Record" class="time">00:31.68</td>
                                <td data-label="Fecha">4/19/2020</td>
                                <td data-label="Competencia">CHAMPIONSHIP MASTER</td>
                            </tr>
                            <tr>
                                <td data-label="Distancia">50m Libre</td>
                                <td data-label="Atleta">DANIEL MONTOYA</td>
                                <td data-label="Equipo">NNG</td>
                                <td data-label="Categor√≠a">Master D</td>
                                <td data-label="Tiempo Record" class="time">00:34.40</td>
                                <td data-label="Fecha">12/13/2020</td>
                                <td data-label="Competencia">II CHAMPIONSHIP MASTER</td>
                            </tr>
                            <tr>
                                <td data-label="Distancia">50m Libre</td>
                                <td data-label="Atleta">Libardo Pinz√≥n Vivas</td>
                                <td data-label="Equipo">MASTER</td>
                                <td data-label="Categor√≠a">Master E</td>
                                <td data-label="Tiempo Record" class="time">00:32.97</td>
                                <td data-label="Fecha">4/19/2020</td>
                                <td data-label="Competencia">CHAMPIONSHIP MASTER</td>
                            </tr>
                            <tr>
                                <td data-label="Distancia">50m Libre</td>
                                <td data-label="Atleta">Alejo valdez</td>
                                <td data-label="Equipo">DELFINES</td>
                                <td data-label="Categor√≠a">Master G</td>
                                <td data-label="Tiempo Record" class="time">00:45.84</td>
                                <td data-label="Fecha">10/21/2019</td>
                                <td data-label="Competencia">CAIMAN DE ORO</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>

    <!-- Sponsors Section -->
    <section class="sponsors-section">
        <div class="container">
            <h2 class="section-title">Nuestros Patrocinadores</h2>
            <div class="sponsors-grid">
                <a href="#" target="_blank" class="sponsor-card">
                    <div class="sponsor-logo"><img src="https://via.placeholder.com/200x80/FAFAFA/CCCCCC?text=Sponsor+3" alt="Patrocinador 3"></div>
                    <div class="sponsor-name">Empresa Patrocinadora 3</div>
                </a>
                <a href="#" target="_blank" class="sponsor-card">
                    <div class="sponsor-logo"><img src="https://via.placeholder.com/200x80/FAFAFA/CCCCCC?text=Sponsor+4" alt="Patrocinador 4"></div>
                    <div class="sponsor-name">Empresa Patrocinadora 4</div>
                </a>
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="cta-section">
        <div class="container">
            <h2>¬øListo para competir?</h2>
            <p>√önete a los mejores nadadores master en esta emocionante competencia</p>
            <a href="#" class="cta-button">M√°s Informaci√≥n</a>
        </div>
    </section>
    
    <!-- Contact Section -->
    <section class="contact-section">
        <div class="container">
            <h2 class="section-title">Contacto</h2>
            <div class="contact-grid">
                <!-- WhatsApp Card -->
                <a href="https://wa.me/573001234567" target="_blank" class="contact-card-link">
                    <div class="sticker-icon">
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M16.75 13.96C16.41 13.79 15.31 13.24 15.08 13.15C14.86 13.06 14.7 13.02 14.54 13.28C14.38 13.55 13.91 14.11 13.75 14.28C13.59 14.45 13.43 14.47 13.16 14.3C12.89 14.13 12.06 13.85 11.07 12.99C10.29 12.3 9.73 11.48 9.59 11.21C9.45 10.94 9.56 10.81 9.7 10.67C9.83 10.53 9.99 10.33 10.13 10.18C10.27 10.03 10.32 9.9 10.42 9.73C10.52 9.56 10.47 9.4 10.39 9.27C10.31 9.14 9.85 7.97 9.66 7.52C9.47 7.07 9.28 7.13 9.14 7.12H8.62C8.42 7.12 8.13 7.19 7.89 7.43C7.65 7.67 6.96 8.31 6.96 9.56C6.96 10.81 7.92 12.01 8.06 12.18C8.2 12.35 9.85 14.8 12.29 15.76C14.73 16.72 14.73 16.34 15.13 16.3C15.53 16.26 16.54 15.68 16.75 15.13C16.96 14.58 16.96 14.12 16.88 13.96H16.75Z" stroke="#0b5079" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M12.04 21.82C17.56 21.82 22 17.38 22 11.86C22 6.34 17.56 1.9 12.04 1.9C6.52 1.9 2.08 6.34 2.08 11.86C2.08 14.13 2.84 16.24 4.12 17.9L2.56 21.34L6.17 19.95C7.73 21.13 9.79 21.82 12.04 21.82Z" stroke="#00ADEF" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
                    </div>
                    <h3>WhatsApp</h3>
                    <p>+57 300 123 4567</p>
                </a>
                <!-- Instagram Card -->
                <a href="https://www.instagram.com/tu_usuario" target="_blank" class="contact-card-link">
                    <div class="sticker-icon">
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="2" y="2" width="20" height="20" rx="5" ry="5" stroke="#00ADEF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M16 11.37C16 13.38 14.21 15 12 15C9.79 15 8 13.38 8 11.37C8 9.36 9.79 7.75 12 7.75C14.21 7.75 16 9.36 16 11.37Z" stroke="#0b5079" stroke-width="2"/><path d="M17.5 6.5H17.51" stroke="#0b5079" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                    </div>
                    <h3>Instagram</h3>
                    <p>@AquaTEN_Club</p>
                </a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2024 AquaTEN - Club Deportivo</p>
            <p>IV Championship Master - Todos los derechos reservados</p>
        </div>
    </footer>

    <script>
        // Variables globales
        let lastUpdateTime = null;
        let loadAttempts = 0;
        const MAX_ATTEMPTS = 3;

        // Elementos DOM
        const statusIndicator = document.getElementById('statusIndicator');
        const lastUpdateElement = document.getElementById('lastUpdateTime');
        const resultsTable = document.getElementById('resultsTable');

        // Funci√≥n para actualizar el indicador de estado
        function updateStatus(type, message) {
            statusIndicator.className = `status-indicator status-${type}`;
            statusIndicator.textContent = message;
            
            if (type === 'success' || type === 'error') {
                setTimeout(() => {
                    statusIndicator.style.opacity = '0';
                    setTimeout(() => {
                        statusIndicator.style.display = 'none';
                    }, 300);
                }, 3000);
            }
        }

        // Funci√≥n para actualizar tiempo de √∫ltima actualizaci√≥n
        function updateLastUpdateTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('es-CO', {
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                timeZone: 'America/Bogota'
            });
            lastUpdateElement.textContent = timeString;
            lastUpdateTime = now;
        }

        // Parser CSV mejorado y optimizado
        function parseCSV(csvText) {
            const rows = [];
            const lines = csvText.split('\n');
            
            for (let line of lines) {
                if (!line.trim()) continue;
                
                const cols = [];
                let currentCol = '';
                let inQuotes = false;
                
                for (let i = 0; i < line.length; i++) {
                    const char = line[i];
                    const nextChar = line[i + 1];
                    
                    if (char === '"') {
                        if (inQuotes && nextChar === '"') {
                            currentCol += '"';
                            i++; // Saltar la siguiente comilla
                        } else {
                            inQuotes = !inQuotes;
                        }
                    } else if (char === ',' && !inQuotes) {
                        cols.push(currentCol.trim());
                        currentCol = '';
                    } else {
                        currentCol += char;
                    }
                }
                
                cols.push(currentCol.trim());
                
                if (cols.some(cell => cell && cell.trim() !== '')) {
                    rows.push(cols);
                }
            }
            
            return rows;
        }

        // Configuraci√≥n: Usar API Key habilitada con manejo de CORS
        const USE_API_KEY = true; // ‚úÖ API Key habilitada
        const API_KEY = 'AIzaSyDcUEGyS6grOV_p8Z6d9WofiFNMYQBblIk'; // ‚úÖ Tu API Key
        
        // M√©todo principal para cargar datos desde Google Sheets
        async function loadSheetData() {
            loadAttempts++;
            updateStatus('loading', 'üîÑ Cargando resultados...');
            
            // Si est√° deshabilitada la API Key, ir directo a CSV
            if (!USE_API_KEY) {
                console.log('üìÑ Usando solo m√©todo CSV (API Key deshabilitada)');
                await loadSheetDataAlternative();
                return;
            }
            
            try {
                const SHEET_ID = '1AKzRm64pn_1JaL4n0Tx3xupfDdkU91Oc-nN2kf7z4PE';
                
                // Probar diferentes rangos y nombres de hoja
                const ranges = [
                    'RECORD%20MASTER!A:Z',  // Tu hoja principal con m√°s columnas
                    'RECORD%20MASTER!A:G',  // Tu hoja principal
                    'RECORD%20MASTER!A1:Z1000', // Rango espec√≠fico
                    'A:Z',  // Sin especificar hoja, m√°s columnas
                    'A1:Z1000' // Rango espec√≠fico sin hoja
                ];
                
                let data = null;
                let activeRange = '';
                
                console.log('üîë Intentando con API Key...');
                
                // Intentar con API Key primero
                for (const range of ranges) {
                    try {
                        const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${range}?key=${API_KEY}`;
                        console.log(`üîç Probando rango con API Key: ${range}`);
                        
                        const response = await fetch(url, {
                            method: 'GET',
                            headers: {
                                'Accept': 'application/json',
                                'Cache-Control': 'no-cache',
                                'Pragma': 'no-cache'
                            },
                            mode: 'cors', // Expl√≠citamente permitir CORS
                            credentials: 'omit' // No enviar credentials
                        });
                        
                        console.log(`üìä Respuesta API: ${response.status} ${response.statusText}`);
                        
                        if (response.ok) {
                            const responseData = await response.json();
                            console.log(`üìä Datos recibidos para ${range}:`, responseData);
                            
                            if (responseData.values && responseData.values.length > 0) {
                                data = responseData;
                                activeRange = range;
                                console.log(`‚úÖ Datos encontrados en: ${range} (${responseData.values.length} filas)`);
                                break;
                            } else {
                                console.log(`‚ö†Ô∏è Sin datos en rango: ${range}`);
                            }
                        } else {
                            const errorData = await response.json();
                            console.log(`‚ùå Error API ${response.status} en ${range}:`, errorData);
                            
                            // Si es error 403 de referentes, intentar con CSV
                            if (response.status === 403) {
                                console.log('üîÑ Error 403 detectado, probando m√©todo CSV...');
                                await loadSheetDataAlternative();
                                return;
                            }
                        }
                    } catch (rangeError) {
                        console.log(`‚ùå Error de conexi√≥n en rango ${range}:`, rangeError.message);
                        console.log('üîÑ Failed to fetch detectado, probando m√©todo CSV...');
                        
                        // Si es el primer rango y falla, ir directo a CSV
                        if (range === ranges[0]) {
                            await loadSheetDataAlternative();
                            return;
                        }
                        continue;
                    }
                }
                
                if (data && data.values && data.values.length > 0) {
                    updateResultsTable(data.values);
                    updateLastUpdateTime();
                    updateStatus('success', '‚úÖ Datos cargados con API Key');
                    loadAttempts = 0;
                    console.log(`üéâ ${data.values.length} filas cargadas exitosamente desde: ${activeRange}`);
                } else {
                    console.log('‚ö†Ô∏è Sin datos con API Key, probando m√©todo CSV...');
                    await loadSheetDataAlternative();
                }
                
            } catch (error) {
                console.error('‚ùå Error general con API Key:', error);
                console.log('üîÑ Fallback a m√©todo CSV debido a error general...');
                await loadSheetDataAlternative();
            }
        }

        // M√©todo alternativo usando exportaci√≥n CSV (Anti Failed to Fetch)
        async function loadSheetDataAlternative() {
            try {
                const SHEET_ID = '1AKzRm64pn_1JaL4n0Tx3xupfDdkU91Oc-nN2kf7z4PE';
                
                // URLs optimizadas para evitar CORS y Failed to Fetch
                const exportUrls = [
                    // M√©todo 1: Exportaci√≥n directa (m√°s confiable)
                    `https://docs.google.com/spreadsheets/d/${SHEET_ID}/export?format=csv&gid=0`,
                    `https://docs.google.com/spreadsheets/d/${SHEET_ID}/export?format=csv`,
                    
                    // M√©todo 2: Con par√°metros adicionales para evitar cache
                    `https://docs.google.com/spreadsheets/d/${SHEET_ID}/export?format=csv&gid=0&timestamp=${Date.now()}`,
                    `https://docs.google.com/spreadsheets/d/${SHEET_ID}/export?format=csv&cachebust=${Math.random()}`,
                    
                    // M√©todo 3: Google Visualization API (√∫ltima opci√≥n)
                    `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:csv&sheet=RECORD%20MASTER`,
                ];
                
                let csvText = '';
                let successUrl = '';
                let lastError = '';
                
                console.log('üìÑ Iniciando m√©todo CSV alternativo...');
                
                for (const url of exportUrls) {
                    try {
                        console.log('üîÑ Probando URL CSV:', url.substring(0, 80) + '...');
                        
                        // Configuraci√≥n anti "Failed to fetch"
                        const fetchConfig = {
                            method: 'GET',
                            headers: {
                                'Cache-Control': 'no-cache, no-store, must-revalidate',
                                'Pragma': 'no-cache',
                                'Expires': '0'
                            },
                            mode: 'cors',
                            credentials: 'omit',
                            // Timeout personalizado
                            signal: AbortSignal.timeout ? AbortSignal.timeout(10000) : undefined
                        };
                        
                        const response = await fetch(url, fetchConfig);
                        
                        console.log(`üìä Respuesta CSV: ${response.status} ${response.statusText}`);
                        
                        if (response.ok) {
                            csvText = await response.text();
                            console.log('üìÑ Texto CSV recibido (primeros 300 chars):', csvText.substring(0, 300));
                            
                            // Validaciones m√°s estrictas para evitar HTML de error
                            const isValidCSV = csvText && 
                                             csvText.trim() !== '' && 
                                             !csvText.includes('<!DOCTYPE') &&
                                             !csvText.includes('<html') &&
                                             !csvText.includes('<HTML') &&
                                             !csvText.includes('Error') &&
                                             !csvText.includes('Access denied') &&
                                             !csvText.includes('Permission denied') &&
                                             csvText.length > 20 &&
                                             (csvText.includes(',') || csvText.includes('\n'));
                            
                            if (isValidCSV) {
                                successUrl = url;
                                console.log('‚úÖ CSV v√°lido obtenido de:', url.substring(0, 60) + '...');
                                break;
                            } else {
                                console.log('‚ö†Ô∏è CSV inv√°lido o contiene errores');
                                lastError = 'CSV inv√°lido o contiene HTML de error';
                            }
                        } else {
                            lastError = `HTTP ${response.status}: ${response.statusText}`;
                            console.log('‚ùå Error HTTP:', lastError);
                            
                            // Leer el contenido del error para m√°s informaci√≥n
                            try {
                                const errorText = await response.text();
                                if (errorText.length < 500) {
                                    console.log('üìÑ Contenido del error:', errorText);
                                }
                            } catch (e) {
                                console.log('‚ùå No se pudo leer el contenido del error');
                            }
                        }
                    } catch (urlError) {
                        lastError = urlError.message;
                        console.log('‚ùå Error en URL:', url.substring(0, 60) + '...', urlError.message);
                        
                        // Informaci√≥n adicional sobre el tipo de error
                        if (urlError.name === 'TypeError' && urlError.message.includes('Failed to fetch')) {
                            console.log('üö® Error "Failed to fetch" detectado. Posibles causas:');
                            console.log('   - Problemas de CORS');
                            console.log('   - Google Sheet no es p√∫blico');
                            console.log('   - Problemas de red');
                            console.log('   - Bloqueador de anuncios activo');
                        }
                        continue;
                    }
                }
                
                if (!csvText || csvText.trim() === '') {
                    throw new Error(`No se pudo obtener datos v√°lidos de ninguna URL. √öltimo error: ${lastError}`);
                }
                
                const rows = parseCSV(csvText);
                console.log('üìä Filas parseadas desde CSV:', rows.length);
                console.log('üìÑ Primeras 3 filas:', rows.slice(0, 3));
                
                if (rows && rows.length > 0) {
                    updateResultsTable(rows);
                    updateLastUpdateTime();
                    updateStatus('success', '‚úÖ Datos cargados (CSV)');
                    loadAttempts = 0;
                    console.log(`‚úÖ ${rows.length} filas cargadas exitosamente (m√©todo CSV)`);
                } else {
                    throw new Error('No se encontraron datos v√°lidos en el CSV parseado');
                }
                
            } catch (error) {
                console.error('‚ùå Error cargando datos (m√©todo CSV):', error);
                
                if (loadAttempts < MAX_ATTEMPTS) {
                    updateStatus('loading', `üîÑ Reintentando... (${loadAttempts}/${MAX_ATTEMPTS})`);
                    setTimeout(() => loadSheetData(), 5000);
                } else {
                    updateStatus('error', '‚ùå Error cargando datos');
                    showErrorFallback();
                }
            }
        }

        // Funci√≥n mejorada para mostrar datos de fallback con diagn√≥stico
        function showErrorFallback() {
            const tbody = document.querySelector('#1500m-libre .results-table tbody');
            if (!tbody) return;
            
            tbody.innerHTML = `
                <tr>
                    <td colspan="7" style="text-align: center; padding: 40px; color: #f44336;">
                        ‚ùå Error: "Failed to fetch"<br>
                        <small style="color: #666; margin-top: 15px; display: block; line-height: 1.5;">
                            <strong>Posibles soluciones:</strong><br>
                            1. Verificar que el Google Sheet sea p√∫blico<br>
                            2. Desactivar bloqueador de anuncios temporalmente<br>
                            3. Verificar conexi√≥n a internet<br>
                            4. Probar en modo inc√≥gnito del navegador<br>
                            5. Verificar configuraciones de CORS del servidor
                        </small>
                        <div style="margin-top: 20px;">
                            <button onclick="retryLoad()" style="margin: 5px; padding: 8px 16px; background: #00ADEF; color: white; border: none; border-radius: 4px; cursor: pointer;">
                                üîÑ Reintentar
                            </button>
                            <button onclick="diagnoseFetchError().then(result => console.log('Diagn√≥stico:', result))" style="margin: 5px; padding: 8px 16px; background: #ff9800; color: white; border: none; border-radius: 4px; cursor: pointer;">
                                üîç Diagnosticar
                            </button>
                            <button onclick="checkSheetPublic()" style="margin: 5px; padding: 8px 16px; background: #9c27b0; color: white; border: none; border-radius: 4px; cursor: pointer;">
                                üìä Verificar Sheet
                            </button>
                        </div>
                    </td>
                </tr>`;
        }

        // Funci√≥n para verificar si el Google Sheet es p√∫blico
        async function checkSheetPublic() {
            const SHEET_ID = '1AKzRm64pn_1JaL4n0Tx3xupfDdkU91Oc-nN2kf7z4PE';
            const publicUrl = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/edit`;
            
            console.log('üîç Verificando si el Google Sheet es p√∫blico...');
            console.log('üìã URL del Sheet:', publicUrl);
            
            // Abrir en nueva ventana para que el usuario pueda verificar
            const newWindow = window.open(publicUrl, '_blank');
            
            if (newWindow) {
                console.log('‚úÖ Google Sheet abierto en nueva ventana');
                console.log('üîß Verifica que el Sheet sea p√∫blico:');
                console.log('   1. Clic en "Compartir" (bot√≥n azul)');
                console.log('   2. Cambiar a "Cualquier persona con el enlace puede ver"');
                console.log('   3. Asegurarse de que sea "Viewer" (no Editor)');
                console.log('   4. Guardar cambios');
                
                alert('Google Sheet abierto en nueva ventana.\n\nVerifica que sea p√∫blico:\n1. Clic en "Compartir"\n2. "Cualquier persona con el enlace puede ver"\n3. Rol: "Viewer"\n\nLuego cierra esta ventana y haz clic en "Reintentar"');
            } else {
                console.log('‚ùå No se pudo abrir nueva ventana (bloqueador de pop-ups)');
                alert('No se pudo abrir autom√°ticamente.\n\nVe manualmente a:\n' + publicUrl + '\n\nY verifica que sea p√∫blico.');
            }
        }

        // Funci√≥n de prueba espec√≠fica para tu Google Sheet y API Key;">
                        ‚ùå No se pudieron cargar los datos desde Google Sheets<br>
                        <small style="color: #a5a5a5; margin-top: 10px; display: block;">
                            Verifica que el Google Sheet sea p√∫blico o intenta recargar la p√°gina
                        </small>
                        <button onclick="retryLoad()" style="margin-top: 15px; padding: 10px 20px; background: #00ADEF; color: white; border: none; border-radius: 5px; cursor: pointer;">
                            üîÑ Reintentar
                        </button>
                    </td>
                </tr>`;
        }

        // Funci√≥n para reintentar carga manualmente
        function retryLoad() {
            loadAttempts = 0;
            loadSheetData();
        }

        // Funci√≥n mejorada para actualizar la tabla de resultados
        function updateResultsTable(data) {
            const tbody = document.querySelector('#1500m-libre .results-table tbody');
            if (!tbody) return;
            
            console.log('üìä Procesando', data.length, 'filas de datos');
            console.log('üîç Primeras 3 filas:', data.slice(0, 3));
            
            let htmlContent = '';
            let currentCategory = '';
            let processedRows = 0;
            
            // Detectar si la primera fila son headers
            let startRow = 0;
            if (data[0] && data[0].length > 0) {
                const firstCell = data[0][0] ? data[0][0].toString().toLowerCase() : '';
                if (firstCell.includes('pos') || firstCell.includes('lugar') || 
                    firstCell.includes('puesto') || firstCell.includes('#') ||
                    firstCell.includes('rank') || firstCell === '1') {
                    startRow = 1;
                    console.log('üìã Headers detectados en fila 1, iniciando desde fila 2');
                }
            }
            
            // Procesar datos fila por fila
            for (let i = startRow; i < data.length; i++) {
                const row = data[i];
                if (!row || row.length === 0) continue;
                
                console.log(`üîç Procesando fila ${i}:`, row);
                
                // Variables para los datos
                let pos, nadadora, equipo, edad, categoria, tiempo, puntos;
                
                // Detectar autom√°ticamente la estructura de datos
                // Buscar patrones en las columnas
                for (let j = 0; j < row.length; j++) {
                    const cell = row[j] ? row[j].toString().trim() : '';
                    
                    // Detectar categor√≠a (palabras clave)
                    if (cell.match(/^(INFANTIL|JUVENIL|MAYORES|MASTER|SENIOR)/i) && !categoria) {
                        categoria = cell;
                        console.log(`üìÇ Categor√≠a detectada en columna ${j}: ${categoria}`);
                    }
                    
                    // Detectar posici√≥n (n√∫meros 1-10 al inicio)
                    if (cell.match(/^[1-9]$/) && !pos) {
                        pos = cell;
                    }
                    
                    // Detectar tiempo (formato mm:ss.ss)
                    if (cell.match(/^\d{1,2}:\d{2}\.\d{2}$/) && !tiempo) {
                        tiempo = cell;
                    }
                    
                    // Detectar puntos (n√∫meros > 10)
                    if (cell.match(/^\d{1,2}$/) && parseInt(cell) > 10 && !puntos) {
                        puntos = cell;
                    }
                    
                    // Detectar edad (n√∫meros 10-99)
                    if (cell.match(/^\d{2}$/) && !edad) {
                        edad = cell;
                    }
                    
                    // Detectar equipo (siglas 2-4 letras)
                    if (cell.match(/^[A-Z]{2,4}$/) && !equipo) {
                        equipo = cell;
                    }
                    
                    // Detectar nadadora (texto largo, nombres)
                    if (cell.length > 5 && cell.match(/[a-zA-Z\s]+/) && 
                        !cell.match(/^(INFANTIL|JUVENIL|MAYORES|MASTER)/i) && 
                        !nadadora) {
                        nadadora = cell;
                    }
                }
                
                // Si no encontramos patrones, usar estructura secuencial
                if (!pos && !nadadora && !categoria) {
                    if (row.length >= 7) {
                        [pos, nadadora, equipo, edad, categoria, tiempo, puntos] = row;
                    } else if (row.length >= 6) {
                        [pos, nadadora, equipo, categoria, tiempo, puntos] = row;
                        edad = '-';
                    } else if (row.length >= 5) {
                        [pos, nadadora, categoria, tiempo, puntos] = row;
                        equipo = '-';
                        edad = '-';
                    } else if (row.length >= 3) {
                        [nadadora, categoria, tiempo] = row;
                        pos = '-';
                        equipo = '-';
                        edad = '-';
                        puntos = '-';
                    }
                }
                
                // Limpiar y validar datos
                categoria = categoria ? categoria.toString().trim().toUpperCase() : '';
                nadadora = nadadora ? nadadora.toString().trim() : '';
                pos = pos ? pos.toString().trim() : '';
                
                console.log(`üìù Datos procesados: pos=${pos}, nadadora=${nadadora}, categoria=${categoria}`);
                
                // Skip filas completamente vac√≠as
                if (!categoria && !nadadora && !pos) continue;
                
                // Si es solo una categor√≠a sin nadadora, probablemente es un header de categor√≠a
                if (categoria && (!nadadora || nadadora === '' || nadadora === '-') && 
                    categoria.match(/^(INFANTIL|JUVENIL|MAYORES|MASTER)/i)) {
                    if (categoria !== currentCategory) {
                        currentCategory = categoria;
                        htmlContent += `
                            <tr class="category-header">
                                <td colspan="7">${categoria}</td>
                            </tr>`;
                        console.log(`üìÇ Header de categor√≠a agregado: ${categoria}`);
                    }
                    continue;
                }
                
                // Si cambia la categor√≠a y hay nadadora, agregar header
                if (categoria && categoria !== currentCategory && categoria !== '' && 
                    categoria !== '-' && nadadora && nadadora !== '') {
                    currentCategory = categoria;
                    htmlContent += `
                        <tr class="category-header">
                            <td colspan="7">${categoria}</td>
                        </tr>`;
                    console.log(`üìÇ Nuevo header de categor√≠a: ${categoria}`);
                }
                
                // Agregar fila de resultado si hay nadadora
                if (nadadora && nadadora !== '' && nadadora !== '-' && 
                    !nadadora.toLowerCase().includes('sin participantes') &&
                    !nadadora.toLowerCase().includes('vac√≠o') &&
                    !nadadora.toLowerCase().includes('vacio') &&
                    nadadora.length > 2) {
                    
                    // Generar medallas/posiciones
                    let displayPos = '';
                    if (pos == 1 || pos === '1') displayPos = 'ü•á 1¬∞';
                    else if (pos == 2 || pos === '2') displayPos = 'ü•à 2¬∞';
                    else if (pos == 3 || pos === '3') displayPos = 'ü•â 3¬∞';
                    else if (pos && pos !== '-' && pos !== '') displayPos = `${pos}¬∞`;
                    else displayPos = '-';
                    
                    htmlContent += `
                        <tr>
                            <td data-label="Pos." class="rank">${displayPos}</td>
                            <td data-label="Nadadora">${nadadora}</td>
                            <td data-label="Equipo">${equipo || '-'}</td>
                            <td data-label="Edad">${edad || '-'}</td>
                            <td data-label="Categor√≠a">${categoria || '-'}</td>
                            <td data-label="Tiempo Final" class="time">${tiempo || '-'}</td>
                            <td data-label="Puntos" class="points">${puntos || '-'}</td>
                        </tr>`;
                    processedRows++;
                    console.log(`‚úÖ Fila agregada: ${nadadora} - ${categoria}`);
                }
            }
            
            // Si no se proces√≥ nada, mostrar mensaje
            if (htmlContent === '') {
                htmlContent = `
                    <tr>
                        <td colspan="7" style="text-align: center; padding: 40px; color: #a5a5a5;">
                            üìù Datos disponibles pero estructura no reconocida<br>
                            <small style="display: block; margin-top: 10px; color: #666;">
                                Total de filas: ${data.length} | Filas con datos: ${data.filter(row => row && row.length > 0).length}
                            </small>
                            <button onclick="showRawData()" style="margin-top: 15px; padding: 8px 16px; background: #00ADEF; color: white; border: none; border-radius: 4px; cursor: pointer;">
                                Ver datos raw
                            </button>
                        </td>
                    </tr>`;
            }
            
            tbody.innerHTML = htmlContent;
            resultsTable.classList.remove('loading');
            
            console.log(`‚úÖ Tabla actualizada: ${processedRows} resultados de ${data.length} filas`);
            
            // Guardar datos para debugging
            window.lastLoadedData = data;
        }

        // Funci√≥n para mostrar datos raw (debugging)
        function showRawData() {
            if (window.lastLoadedData) {
                console.log('üìä DATOS RAW COMPLETOS:', window.lastLoadedData);
                alert(`Datos cargados: ${window.lastLoadedData.length} filas.\nRevisa la consola (F12) para ver los datos completos.`);
            }
        }

        // Funciones para tabs
        function openTab(evt, tabName) {
            var i, tabcontent, tabbuttons;
            
            tabcontent = document.getElementsByClassName("tab-content");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].classList.remove("active");
            }
            
            tabbuttons = document.getElementsByClassName("tab-button");
            for (i = 0; i < tabbuttons.length; i++) {
                tabbuttons[i].classList.remove("active");
            }
            
            document.getElementById(tabName).classList.add("active");
            evt.currentTarget.classList.add("active");
        }

        // Funci√≥n para recargar datos autom√°ticamente
        function startAutoReload() {
            // Cargar datos inicialmente
            loadSheetData();
            
            // Recargar cada 30 segundos
            setInterval(() => {
                console.log('üîÑ Recarga autom√°tica programada...');
                loadSheetData();
            }, 30000);
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ P√°gina cargada, iniciando sistema de actualizaci√≥n autom√°tica...');
            console.log('üìã Tu Google Sheet: "RECORD MASTER"');
            console.log('üîë API Key habilitada:', API_KEY);
            console.log('üìä ID del Sheet:', '1AKzRm64pn_1JaL4n0Tx3xupfDdkU91Oc-nN2kf7z4PE');
            
            // Agregar bot√≥n de prueba temporal
            addTestButton();
            
            startAutoReload();
        });

        // Funci√≥n para agregar bot√≥n de prueba (temporal)
        function addTestButton() {
            const testButton = document.createElement('button');
            testButton.innerHTML = 'üîë Probar API Key';
            testButton.style.cssText = `
                position: fixed;
                bottom: 20px;
                right: 20px;
                z-index: 9999;
                padding: 12px 24px;
                background: linear-gradient(135deg, #4CAF50, #45a049);
                color: white;
                border: none;
                border-radius: 25px;
                cursor: pointer;
                font-weight: 600;
                font-size: 14px;
                box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
                transition: all 0.3s ease;
            `;
            
            testButton.onmouseover = function() {
                this.style.transform = 'translateY(-2px)';
                this.style.boxShadow = '0 6px 20px rgba(76, 175, 80, 0.4)';
            };
            
            testButton.onmouseout = function() {
                this.style.transform = 'translateY(0)';
                this.style.boxShadow = '0 4px 15px rgba(76, 175, 80, 0.3)';
            };
            
            testButton.onclick = function() {
                console.log('üß™ Iniciando prueba manual con API Key...');
                testButton.innerHTML = '‚è≥ Probando...';
                testButton.style.background = 'linear-gradient(135deg, #ff9800, #f57c00)';
                
                loadAttempts = 0;
                loadSheetData().then(() => {
                    testButton.innerHTML = '‚úÖ Completado';
                    testButton.style.background = 'linear-gradient(135deg, #4CAF50, #45a049)';
                    setTimeout(() => {
                        testButton.innerHTML = 'üîë Probar API Key';
                    }, 2000);
                });
            };
            
            document.body.appendChild(testButton);
            
            // Remover bot√≥n despu√©s de 3 minutos
            setTimeout(() => {
                if (testButton.parentNode) {
                    testButton.style.opacity = '0';
                    setTimeout(() => {
                        if (testButton.parentNode) {
                            testButton.parentNode.removeChild(testButton);
                        }
                    }, 300);
                }
            }, 180000);
        }

        // Funci√≥n de diagn√≥stico avanzado para "Failed to fetch"
        async function diagnoseFetchError() {
            console.log('üîç === DIAGN√ìSTICO COMPLETO DE "FAILED TO FETCH" ===');
            
            const SHEET_ID = '1AKzRm64pn_1JaL4n0Tx3xupfDdkU91Oc-nN2kf7z4PE';
            
            // Test 1: Verificar conectividad b√°sica
            console.log('üì° Test 1: Verificando conectividad b√°sica...');
            try {
                const testUrl = 'https://www.google.com/favicon.ico';
                const testResponse = await fetch(testUrl, { mode: 'no-cors' });
                console.log('‚úÖ Conectividad b√°sica: OK');
            } catch (error) {
                console.log('‚ùå Sin conectividad b√°sica:', error.message);
                return { error: 'NO_INTERNET', message: 'Sin conexi√≥n a internet' };
            }
            
            // Test 2: Verificar acceso a Google Sheets (p√∫blico)
            console.log('üìä Test 2: Verificando acceso p√∫blico al Google Sheet...');
            const publicUrl = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/edit`;
            try {
                const response = await fetch(publicUrl, { 
                    method: 'HEAD', 
                    mode: 'no-cors',
                    credentials: 'omit'
                });
                console.log('‚úÖ Google Sheet accesible');
            } catch (error) {
                console.log('‚ö†Ô∏è Problema de acceso al Google Sheet:', error.message);
            }
            
            // Test 3: Verificar URLs de exportaci√≥n espec√≠ficas
            console.log('üìÑ Test 3: Verificando URLs de exportaci√≥n...');
            const testUrls = [
                `https://docs.google.com/spreadsheets/d/${SHEET_ID}/export?format=csv&gid=0`,
                `https://docs.google.com/spreadsheets/d/${SHEET_ID}/export?format=csv`
            ];
            
            for (const url of testUrls) {
                try {
                    console.log(`üîó Probando: ${url.substring(0, 70)}...`);
                    const response = await fetch(url, {
                        method: 'HEAD', // Solo headers, sin contenido
                        mode: 'cors',
                        credentials: 'omit'
                    });
                    console.log(`‚úÖ URL accesible: ${response.status} ${response.statusText}`);
                    
                    if (response.ok) {
                        // Ahora probar GET completo
                        const fullResponse = await fetch(url);
                        const content = await fullResponse.text();
                        console.log(`üìä Contenido obtenido: ${content.length} caracteres`);
                        
                        if (content.length > 50 && !content.includes('<!DOCTYPE')) {
                            console.log('üéâ ¬°Esta URL funciona correctamente!');
                            return { 
                                success: true, 
                                workingUrl: url, 
                                content: content.substring(0, 200) 
                            };
                        }
                    }
                } catch (error) {
                    console.log(`‚ùå Error en URL: ${error.message}`);
                    
                    if (error.message.includes('Failed to fetch')) {
                        console.log('üö® "Failed to fetch" detectado en esta URL');
                    }
                }
            }
            
            // Test 4: Verificar configuraciones del navegador
            console.log('üîß Test 4: Verificando configuraciones del navegador...');
            console.log('   - User Agent:', navigator.userAgent);
            console.log('   - Online:', navigator.onLine);
            console.log('   - Cookies habilitadas:', navigator.cookieEnabled);
            
            // Test 5: Verificar si hay bloqueadores
            console.log('üõ°Ô∏è Test 5: Verificando posibles bloqueos...');
            if (typeof window.adblockDetected !== 'undefined') {
                console.log('‚ö†Ô∏è Bloqueador de anuncios detectado');
            }
            
            return { error: 'FETCH_FAILED', message: 'Todas las URLs fallan con "Failed to fetch"' };
        }
        async function testSheetConnection() {
            console.log('üîç === PRUEBA COMPLETA DE CONEXI√ìN ===');
            console.log('üîë API Key:', API_KEY);
            console.log('üìä Sheet ID:', '1AKzRm64pn_1JaL4n0Tx3xupfDdkU91Oc-nN2kf7z4PE');
            
            const SHEET_ID = '1AKzRm64pn_1JaL4n0Tx3xupfDdkU91Oc-nN2kf7z4PE';
            
            // Prueba 1: API Key con diferentes rangos
            console.log('üì° === PRUEBA 1: API KEY ===');
            const ranges = [
                'RECORD%20MASTER!A:Z', 
                'RECORD%20MASTER!A:G',
                'A:Z', 
                'A1:Z1000',
                'RECORD%20MASTER!A1:Z1000'
            ];
            
            for (const range of ranges) {
                try {
                    const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${range}?key=${API_KEY}`;
                    console.log(`üîó Probando: ${url.substring(0, 80)}...`);
                    
                    const response = await fetch(url, {
                        method: 'GET',
                        headers: {
                            'Accept': 'application/json',
                            'Cache-Control': 'no-cache'
                        }
                    });
                    
                    console.log(`üìä Respuesta ${range}: ${response.status} ${response.statusText}`);
                    
                    if (response.ok) {
                        const data = await response.json();
                        console.log(`‚úÖ √âXITO con API Key!`);
                        console.log(`üìä Filas obtenidas: ${data.values?.length || 0}`);
                        if (data.values && data.values.length > 0) {
                            console.log(`üìÑ Primera fila:`, data.values[0]);
                            console.log(`üìÑ Segunda fila:`, data.values[1]);
                            console.log(`üìÑ Estructura detectada: ${data.values[0]?.length || 0} columnas`);
                            return { success: true, method: 'API_KEY', data: data.values, range };
                        }
                    } else {
                        const errorData = await response.json();
                        console.log(`‚ùå Error API Key detallado:`, errorData);
                        
                        if (response.status === 403) {
                            console.log('üö® Error 403: Problema de permisos o referentes');
                        } else if (response.status === 400) {
                            console.log('üö® Error 400: Problema con el rango o ID del sheet');
                        }
                    }
                } catch (error) {
                    console.log(`‚ùå Error de conexi√≥n API Key en ${range}:`, error.message);
                }
            }
            
            // Prueba 2: Exportaci√≥n CSV como fallback
            console.log('üìÑ === PRUEBA 2: EXPORTACI√ìN CSV ===');
            const csvUrls = [
                `https://docs.google.com/spreadsheets/d/${SHEET_ID}/export?format=csv&gid=0`,
                `https://docs.google.com/spreadsheets/d/${SHEET_ID}/export?format=csv`,
                `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:csv`,
                `https://docs.google.com/spreadsheets/d/${SHEET_ID}/export?format=csv&gid=0&timestamp=${Date.now()}`
            ];
            
            for (const url of csvUrls) {
                try {
                    console.log(`üîó Probando CSV: ${url.substring(0, 80)}...`);
                    const response = await fetch(url, {
                        method: 'GET',
                        headers: {
                            'Cache-Control': 'no-cache, no-store, must-revalidate'
                        }
                    });
                    
                    console.log(`üìä Respuesta CSV: ${response.status} ${response.statusText}`);
                    
                    if (response.ok) {
                        const text = await response.text();
                        console.log(`üìù Longitud del CSV: ${text.length} caracteres`);
                        console.log(`üìÑ Primeros 200 caracteres:`, text.substring(0, 200));
                        
                        if (text && text.length > 50 && !text.includes('<!DOCTYPE') && text.includes(',')) {
                            const rows = parseCSV(text);
                            console.log(`‚úÖ √âXITO con CSV!`);
                            console.log(`üìä Filas parseadas: ${rows.length}`);
                            if (rows.length > 0) {
                                console.log(`üìÑ Primera fila CSV:`, rows[0]);
                                console.log(`üìÑ Segunda fila CSV:`, rows[1]);
                                return { success: true, method: 'CSV', data: rows, url };
                            }
                        } else {
                            console.log('‚ö†Ô∏è CSV inv√°lido o vac√≠o');
                        }
                    }
                } catch (error) {
                    console.log(`‚ùå Error CSV:`, error.message);
                }
            }
            
            console.log('‚ùå === TODAS LAS PRUEBAS FALLARON ===');
            console.log('üîß Posibles soluciones:');
            console.log('   1. Verificar que el Google Sheet sea p√∫blico');
            console.log('   2. Revisar restricciones de la API Key en Google Cloud Console');
            console.log('   3. Verificar que la API de Google Sheets est√© habilitada');
            
            return { success: false, method: 'NONE', data: null };
        }

        // Recargar cuando la ventana vuelva al foco
        window.addEventListener('focus', function() {
            if (lastUpdateTime && (Date.now() - lastUpdateTime.getTime()) > 60000) {
                console.log('üëÅÔ∏è Ventana enfocada, recargando datos...');
                loadSheetData();
            }
        });

        // Recargar cuando se restaure la conexi√≥n a internet
        window.addEventListener('online', function() {
            console.log('üåê Conexi√≥n restaurada, recargando datos...');
            loadAttempts = 0;
            loadSheetData();
        });

        // Mostrar estado offline
        window.addEventListener('offline', function() {
            updateStatus('error', 'üì° Sin conexi√≥n a internet');
        });

        // Funci√≥n global para debugging
        window.debugSheet = testSheetConnection;
        window.reloadData = loadSheetData;
        
        console.log('üõ†Ô∏è Funciones de debugging disponibles:');
        console.log('   window.debugSheet() - Prueba completa de conexi√≥n');
        console.log('   window.reloadData() - Recargar datos manualmente');
        console.log('   window.lastLoadedData - Ver √∫ltimos datos cargados');
    </script>
</body>
</html>
                    <div class="sponsor-logo"><img src="https://via.placeholder.com/200x80/FAFAFA/CCCCCC?text=Sponsor+1" alt="Patrocinador 1"></div>
                    <div class="sponsor-name">Empresa Patrocinadora 1</div>
                </a>
                <a href="#" target="_blank" class="sponsor-card">
                    <div class="sponsor-logo"><img src="https://via.placeholder.com/200x80/FAFAFA/CCCCCC?text=Sponsor+2" alt="Patrocinador 2"></div>
                    <div class="sponsor-name">Empresa Patrocinadora 2</div>
                </a>
                <a href="#" target="_blank" class="sponsor-card">
                    <div class="sponsor-logo"><img src="https://via.placeholder.com/200x80/FAFAFA/CCCCCC?text=Sponsor+3" alt="Patrocinador 3"></div>
                    <div class="sponsor-name">Empresa Patrocinadora 3</div>
                </a>
                <a href="#" target="_blank" class="sponsor-card">