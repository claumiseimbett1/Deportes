<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IV Championship Master - AquaTEN</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: #ffffff;
            color: #0b1039;
            line-height: 1.6;
        }

        /* Animaciones */
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .loading {
            animation: pulse 2s infinite;
        }

        /* Header */
        .header {
            background-color: #ffffff;
            box-shadow: 0 2px 15px rgba(11, 16, 57, 0.1);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 15px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo-box {
            height: 60px;
            display: flex;
            align-items: center;
        }

        .logo-box img {
            height: 100%;
            width: auto;
        }

        /* Navigation Menu */
        .nav-menu {
            display: flex;
            align-items: center;
        }

        .nav-links {
            display: flex;
            list-style: none;
            gap: 30px;
            margin: 0;
            padding: 0;
        }

        .nav-links li a {
            text-decoration: none;
            color: #0b1039;
            font-weight: 500;
            font-size: 16px;
            padding: 8px 16px;
            border-radius: 20px;
            transition: all 0.3s ease;
            position: relative;
        }

        .nav-links li a:hover {
            background-color: #00ADEF;
            color: white;
            transform: translateY(-2px);
        }

        /* Mobile Menu Toggle */
        .mobile-menu-toggle {
            display: none;
            flex-direction: column;
            cursor: pointer;
            padding: 5px;
            margin: 0 15px;
        }

        .mobile-menu-toggle span {
            width: 25px;
            height: 3px;
            background-color: #0b1039;
            margin: 3px 0;
            transition: 0.3s;
            border-radius: 2px;
        }

        .mobile-menu-toggle.active span:nth-child(1) {
            transform: rotate(-45deg) translate(-5px, 6px);
        }

        .mobile-menu-toggle.active span:nth-child(2) {
            opacity: 0;
        }

        .mobile-menu-toggle.active span:nth-child(3) {
            transform: rotate(45deg) translate(-5px, -6px);
        }

        /* Search Box Styles */
        .search-container {
            margin-bottom: 20px;
            text-align: center;
        }

        .search-box {
            display: inline-flex;
            align-items: center;
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 25px;
            padding: 8px 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            max-width: 400px;
            width: 100%;
        }

        .search-box:focus-within {
            border-color: #00ADEF;
            box-shadow: 0 4px 15px rgba(0, 173, 239, 0.2);
        }

        .search-input {
            border: none;
            outline: none;
            padding: 8px 12px;
            font-size: 16px;
            width: 100%;
            background: transparent;
        }

        .search-input::placeholder {
            color: #999;
        }

        .search-icon {
            color: #666;
            margin-right: 8px;
        }

        .clear-search {
            background: none;
            border: none;
            color: #666;
            cursor: pointer;
            padding: 4px;
            border-radius: 50%;
            transition: background-color 0.3s ease;
        }

        .clear-search:hover {
            background-color: #f0f0f0;
        }

        .search-results-info {
            text-align: center;
            margin: 10px 0;
            color: #666;
            font-size: 14px;
        }

        .highlight-search {
            background-color: #ffeb3b;
            font-weight: bold;
        }

        /* Status indicator */
        .status-indicator {
            position: fixed;
            top: 100px;
            right: 20px;
            z-index: 9999;
            padding: 10px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .status-loading {
            background: #ffa726;
            color: white;
        }

        .status-success {
            background: #4caf50;
            color: white;
        }

        .status-error {
            background: #f44336;
            color: white;
        }

        /* Video Hero Section */
        .video-hero {
            margin-top: 90px;
            position: relative;
            width: 100%;
            height: 70vh;
            min-height: 500px;
            overflow: hidden;
            background-color: #0b1039;
        }

        .video-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .video-container video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border: none;
        }

        .video-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(11, 16, 57, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .hero-content {
            text-align: center;
            z-index: 1;
            padding: 0 20px;
        }

        .hero-content h1 {
            font-size: 4em;
            color: #ffffff;
            margin-bottom: 20px;
            font-weight: 700;
            letter-spacing: -1px;
        }

        .hero-content .subtitle {
            font-size: 1.5em;
            color: #f0f6ff;
            font-weight: 300;
        }

        /* Info & Contact Section */
        .info-section, .contact-section {
            padding: 100px 20px;
            background-color: #ffffff;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .section-title {
            text-align: center;
            font-size: 2.8em;
            color: #0b1039;
            margin-bottom: 60px;
            font-weight: 700;
        }

        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 40px;
            margin-bottom: 60px;
        }
        
        .contact-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            justify-content: center;
            max-width: 800px;
            margin: 0 auto;
        }

        .info-card, .contact-card-link {
            background: #ffffff;
            border: 1px solid #f0f6ff;
            border-radius: 20px;
            padding: 50px 30px;
            text-align: center;
            box-shadow: 0 5px 25px rgba(11, 16, 57, 0.08);
            transition: all 0.3s ease;
            text-decoration: none;
            color: inherit;
        }

        .info-card:hover, .contact-card-link:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 40px rgba(11, 16, 57, 0.15);
            border-color: #00ADEF;
        }

        /* Iconos SVG minimalistas */
        .sticker-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto 25px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .sticker-icon svg {
            width: 100%;
            height: 100%;
        }

        .info-card h3, .contact-card-link h3 {
            color: #0b1039;
            font-size: 1.8em;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .info-card p, .contact-card-link p {
            color: #a5a5a5;
            font-size: 1.1em;
            line-height: 1.8;
        }

        /* Results Section */
        .results-section {
            padding: 100px 20px;
            background: #f0f6ff;
        }

        .results-container {
            background: #ffffff;
            border-radius: 20px;
            padding: 50px;
            box-shadow: 0 10px 40px rgba(11, 16, 57, 0.1);
            border: 2px solid #f0f6ff;
        }

        /* Pesta√±as de Resultados */
        .tabs {
            display: flex;
            margin-bottom: 30px;
            border-bottom: 2px solid #f0f6ff;
            flex-wrap: wrap;
            justify-content: center;
        }

        .tab-button {
            padding: 15px 30px;
            cursor: pointer;
            background-color: transparent;
            border: none;
            border-bottom: 3px solid transparent;
            color: #0b1039;
            font-size: 1.1em;
            transition: all 0.3s ease;
            margin: 0 10px;
            border-radius: 10px 10px 0 0;
            font-weight: 500;
        }

        .tab-button:hover {
            color: #00ADEF;
            background-color: rgba(0, 173, 239, 0.05);
        }

        .tab-button.active {
            color: #00ADEF;
            border-bottom: 3px solid #00ADEF;
            background-color: #f0f6ff;
            font-weight: 600;
        }

        .tab-content {
            display: none;
            padding: 30px 0;
        }

        .tab-content.active {
            display: block;
        }

        .tab-content h3 {
            color: #0b1039;
            margin-bottom: 30px;
            text-align: center;
            font-size: 1.8em;
            font-weight: 600;
        }

        /* Indicador de √∫ltima actualizaci√≥n */
        .last-update {
            text-align: center;
            margin-bottom: 20px;
            color: #a5a5a5;
            font-size: 0.9em;
        }

        .last-update .time {
            color: #00ADEF;
            font-weight: 600;
        }

        /* Tabla de Resultados */
        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background-color: #ffffff;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 25px rgba(11, 16, 57, 0.08);
        }

        .results-table th, .results-table td {
            padding: 15px 20px;
            text-align: left;
            border-bottom: 1px solid #f0f6ff;
        }

        .results-table th {
            background-color: #0b1039;
            color: #ffffff;
            font-weight: 600;
            font-size: 1em;
        }

        .results-table tr:nth-child(even) td {
            background-color: #fafcff;
        }

        .results-table tr:hover td {
            background-color: #f0f6ff;
            transition: background-color 0.3s ease;
        }

        .results-table .rank {
            font-weight: bold;
            color: #0b1039;
            text-align: center;
        }

        .results-table .time {
            font-family: 'Courier New', Courier, monospace;
            font-weight: bold;
            color: #0b1039;
            text-align: center;
        }

        .results-table .points {
            font-weight: bold;
            color: #00ADEF;
            text-align: center;
        }

        /* === CORRECCI√ìN APLICADA AQU√ç === */
        /* Se combinaron las reglas y se aplic√≥ el fondo directamente a las celdas (td) */
        .category-header td {
            background: linear-gradient(135deg, #0b1039 0%, #00ADEF 100%) !important;
            color: #ffffff !important;
            text-align: center;
            font-size: 1.1em;
            font-weight: bold;
            border-bottom: 2px solid #00ADEF !important;
        }

        /* Loading state para la tabla */
        .results-table.loading {
            opacity: 0.7;
        }

        .loading-row {
            text-align: center;
            color: #a5a5a5;
            font-style: italic;
        }

        /* Sponsors Section */
        .sponsors-section {
            padding: 100px 20px;
            background: #ffffff;
        }

        .sponsors-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-top: 50px;
        }

        .sponsor-card {
            background: #ffffff;
            border: 2px solid #f0f6ff;
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            text-decoration: none;
            display: block;
        }

        .sponsor-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(11, 16, 57, 0.15);
            border-color: #00ADEF;
        }

        .sponsor-logo {
            height: 80px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .sponsor-logo img {
            max-height: 100%;
            max-width: 100%;
            object-fit: contain;
            filter: grayscale(100%);
            transition: filter 0.3s ease;
        }

        .sponsor-card:hover .sponsor-logo img {
            filter: grayscale(0%);
        }

        .sponsor-name {
            font-size: 1.2em;
            color: #0b1039;
            font-weight: 600;
        }

        /* CTA Section */
        .cta-section {
            padding: 100px 20px;
            background: linear-gradient(135deg, #0b1039 0%, #0b5079 100%);
            text-align: center;
            position: relative;
        }

        .cta-section h2 {
            color: #ffffff;
            font-size: 3em;
            margin-bottom: 25px;
            font-weight: 700;
        }

        .cta-section p {
            color: #f0f6ff;
            font-size: 1.3em;
            margin-bottom: 40px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .cta-button {
            display: inline-block;
            background: #00ADEF;
            color: #ffffff;
            padding: 18px 50px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            font-size: 1.2em;
            transition: all 0.3s ease;
            box-shadow: 0 5px 20px rgba(0, 173, 239, 0.3);
        }

        .cta-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 30px rgba(0, 173, 239, 0.5);
            background: #0099d8;
        }

        /* Footer */
        .footer {
            background-color: #0b1039;
            color: #ffffff;
            padding: 50px 20px;
            text-align: center;
        }

        .footer p {
            margin-bottom: 10px;
            color: #f0f6ff;
        }

        /* Enfoque completamente nuevo para tabla de equipos m√≥vil */
        @media (max-width: 768px) {
            /* Ocultar completamente la tabla original de equipos */
            #resultsTableTeams {
                display: none;
            }
            
            /* Crear un contenedor custom para mostrar los datos */
            #resultsTableTeams + .mobile-teams-container {
                display: block;
            }
        }
        
        /* Contenedor m√≥vil para equipos (se crear√° din√°micamente) */
        .mobile-teams-container {
            display: none;
        }
        
        .mobile-team-card {
            background: white;
            border: 2px solid #e3f2fd;
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .mobile-team-card .team-position {
            background: #00ADEF;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            display: inline-block;
            margin-bottom: 10px;
        }
        
        .mobile-team-card .team-name {
            font-size: 18px;
            font-weight: bold;
            color: #0b1039;
            margin-bottom: 10px;
        }
        
        .mobile-team-card .team-points {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 10px;
        }
        
        .mobile-team-card .team-points div {
            background: #f8f9fa;
            padding: 8px;
            border-radius: 8px;
            text-align: center;
        }
        
        .mobile-team-card .team-points .label {
            font-size: 12px;
            color: #666;
            margin-bottom: 2px;
        }
        
        .mobile-team-card .team-points .value {
            font-size: 16px;
            font-weight: bold;
            color: #00ADEF;
        }

        /* Estilos adicionales para pantallas muy peque√±as - SOLO equipos */
        @media screen and (max-width: 480px) {
            #resultsTableTeams tr {
                padding: 8px !important;
                margin: 8px 0 !important;
            }
            
            #resultsTableTeams td {
                padding: 4px 0 !important;
                font-size: 13px !important;
                min-height: 28px !important;
            }
            
            #resultsTableTeams td:before {
                font-size: 10px !important;
                font-weight: 600 !important;
            }
            
            /* Reducir espacios generales en todas las tablas m√≥viles */
            .results-table tr {
                margin-bottom: 6px !important;
                padding: 6px !important;
            }
            
            .results-table td {
                padding-top: 12px !important;
                padding-bottom: 3px !important;
                min-height: 25px !important;
                font-size: 13px !important;
            }
            
            .results-table td:before {
                font-size: 10px !important;
                top: 2px !important;
            }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .hero-content h1 {
                font-size: 2.5em;
            }

            .hero-content .subtitle {
                font-size: 1.2em;
            }

            .section-title {
                font-size: 2em;
            }

            .nav-container {
                padding: 15px 20px;
                flex-wrap: wrap;
            }

            /* Mobile Navigation */
            .mobile-menu-toggle {
                display: flex;
                order: 2;
            }

            .nav-menu {
                order: 3;
                width: 100%;
                margin-top: 15px;
                display: none;
            }

            .nav-menu.active {
                display: block;
            }

            .nav-links {
                flex-direction: column;
                gap: 10px;
                background-color: white;
                padding: 20px;
                border-radius: 10px;
                box-shadow: 0 4px 15px rgba(11, 16, 57, 0.1);
            }

            .nav-links li a {
                display: block;
                padding: 12px 20px;
                text-align: center;
                border: 1px solid #e0e0e0;
                margin-bottom: 5px;
            }

            .logo-box:last-child {
                order: 1;
            }

            .logo-box {
                height: 45px;
            }

            .video-hero {
                height: 60vh;
                min-height: 400px;
            }

            .info-section, .results-section, .sponsors-section, .cta-section, .contact-section {
                padding: 60px 20px;
            }

            .sponsors-grid {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 25px;
            }

            .tabs {
                flex-direction: column;
            }

            .tab-button {
                width: 100%;
                text-align: center;
                margin: 5px 0;
                border-radius: 8px;
            }

            .tab-button.active {
                border-left: 3px solid #00ADEF;
                border-bottom: 1px solid #f0f6ff;
            }

            .results-table th, .results-table td {
                padding: 10px 12px;
                font-size: 0.9em;
            }

            .results-table thead {
                display: none;
            }

            .results-table tr {
                display: block;
                margin-bottom: 10px;
                border: 1px solid #f0f6ff;
                border-radius: 6px;
                background-color: #ffffff;
            }

            .results-table td {
                display: block;
                text-align: right;
                padding-left: 45%;
                position: relative;
                padding-top: 18px !important;
                padding-bottom: 6px !important;
                min-height: 35px;
            }

            .results-table td::before {
                content: attr(data-label);
                position: absolute;
                left: 8px;
                font-weight: bold;
                text-align: left;
                color: #0b1039;
            }
            
            /* Asegurar que las tablas regulares tambi√©n funcionen */
            .results-table td:before {
                top: 3px !important;
                left: 8px !important;
                position: absolute !important;
                font-size: 11px !important;
                color: #666 !important;
            }

            .cards-grid, .contact-grid {
                grid-template-columns: 1fr;
                gap: 25px;
            }

            .status-indicator {
                position: relative;
                top: auto;
                right: auto;
                margin: 10px auto;
                display: inline-block;
            }
        }

        /* Share Button Styles */
        .share-cell {
            text-align: center !important;
            padding: 8px !important;
        }

        .share-btn {
            background: linear-gradient(135deg, #1e88e5, #00adef);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
            box-shadow: 0 2px 5px rgba(30, 136, 229, 0.3);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 35px;
            height: 35px;
        }

        .share-btn:hover {
            background: linear-gradient(135deg, #1976d2, #0099cc);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(30, 136, 229, 0.4);
        }

        .share-btn:active {
            transform: translateY(0px);
        }

        /* Share Modal Styles */
        .share-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            animation: fadeIn 0.3s ease;
        }

        .share-modal-content {
            background: white;
            border-radius: 15px;
            padding: 0;
            max-width: 400px;
            width: 90%;
            max-height: 90vh;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            animation: slideUp 0.3s ease;
        }

        .share-modal-header {
            background: linear-gradient(135deg, #1e88e5, #00adef);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .share-modal-header h3 {
            margin: 0;
            font-size: 1.2rem;
        }

        .close-modal {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.3s ease;
        }

        .close-modal:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .share-options {
            padding: 25px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .share-option {
            display: flex;
            align-items: center;
            padding: 15px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
            font-weight: 500;
            text-decoration: none;
            color: #333;
        }

        .share-option:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
        }

        .share-option.whatsapp {
            border-color: #25d366;
            color: #25d366;
        }

        .share-option.whatsapp:hover {
            background: #25d366;
            color: white;
        }

        .share-option.instagram {
            border-color: #e4405f;
            color: #e4405f;
        }

        .share-option.instagram:hover {
            background: #e4405f;
            color: white;
        }

        .share-icon {
            margin-right: 12px;
            font-size: 20px;
        }

        /* Clipboard Notification */
        .clipboard-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #4caf50, #45a049);
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
            z-index: 10001;
            transform: translateX(400px);
            transition: transform 0.3s ease;
            max-width: 300px;
        }

        .clipboard-notification.show {
            transform: translateX(0);
        }

        .notification-content {
            text-align: center;
            font-weight: 500;
        }

        .notification-content small {
            opacity: 0.9;
            font-size: 0.9em;
        }

        /* Responsive adjustments for share button */
        @media (max-width: 768px) {
            .share-btn {
                width: 30px;
                height: 30px;
                font-size: 14px;
                padding: 6px;
            }

            .share-modal-content {
                width: 95%;
                margin: 20px;
            }

            .share-modal-header {
                padding: 15px;
            }

            .share-modal-header h3 {
                font-size: 1.1rem;
            }

            .share-options {
                padding: 20px;
            }

            .share-option {
                padding: 12px 15px;
                font-size: 15px;
            }

            .clipboard-notification {
                right: 10px;
                top: 10px;
                max-width: 280px;
                padding: 12px 16px;
            }
        }

        /* Animation keyframes */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from { 
                opacity: 0;
                transform: translateY(30px);
            }
            to { 
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <nav class="nav-container">
            <div class="logo-box">
                <img src="img/LogoChampion2025.png" alt="Logo IV Championship Master">
            </div>
            
            <!-- Navigation Menu -->
            <div class="nav-menu" id="navMenu">
                <ul class="nav-links">
                    <li><a href="#inicio" onclick="scrollToSection('video-hero')">Inicio</a></li>
                    <li><a href="#informacion" onclick="scrollToSection('info-section')">Informaci√≥n</a></li>
                    <li><a href="#resultados" onclick="scrollToSection('results-section')">Resultados</a></li>
                    <li><a href="#patrocinadores" onclick="scrollToSection('sponsors-section')">Patrocinadores</a></li>
                    <li><a href="#contacto" onclick="scrollToSection('contact-section')">Contacto</a></li>
                </ul>
            </div>
            
            <!-- Mobile Menu Toggle -->
            <div class="mobile-menu-toggle" id="mobileToggle">
                <span></span>
                <span></span>
                <span></span>
            </div>
            
            <div class="logo-box">
                <img src="img/LogoClubes.png" alt="Logo Clubes">
            </div>
        </nav>
    </header>

    <!-- Status Indicator -->
    <div id="statusIndicator" class="status-indicator status-loading">
        üîÑ Cargando resultados...
    </div>
    

    <!-- Video Hero Section -->
    <section class="video-hero" id="inicio">
        <div class="video-container">
            <video autoplay muted loop playsinline src="video/promocional.mp4">
                Tu navegador no soporta la etiqueta de video.
            </video>
        </div>
        <div class="video-overlay">
            <div class="hero-content">
                <h1>IV Championship Master Swimming</h1>
                <p class="subtitle">Competencia de Nataci√≥n</p>
            </div>
        </div>
    </section>

    <!-- Info Section -->
    <section class="info-section" id="informacion">
        <div class="container">
            <h2 class="section-title">Informaci√≥n del Evento</h2>
            <div class="cards-grid">
                <div class="info-card">
                    <div class="sticker-icon">
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2Z" stroke="#00ADEF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M12 6V12L16 14" stroke="#00ADEF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                    </div>
                    <h3>Categor√≠as</h3>
                    <p>Competencias para categor√≠as desde infantil B - +12 a√±os hasta master +99 a√±os</p>
                </div>
                <div class="info-card">
                    <div class="sticker-icon">
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="4" width="18" height="18" rx="2" ry="2" stroke="#0b5079" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><line x1="16" y1="2" x2="16" y2="6" stroke="#0b5079" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><line x1="8" y1="2" x2="8" y2="6" stroke="#0b5079" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><line x1="3" y1="10" x2="21" y2="10" stroke="#0b5079" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                    </div>
                    <h3>Fecha</h3>
                    <p>23 de agosto de 2025 en Piscina de la Villaolimpica en Monteria - C√≥rdoba</p>
                </div>
                <div class="info-card">
                    <div class="sticker-icon">
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 8V12L14.5 14.5" stroke="#00ADEF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M20.9998 12C20.9998 16.9706 16.9704 21 11.9998 21C7.02926 21 2.99982 16.9706 2.99982 12C2.99982 7.02944 7.02926 3 11.9998 3C13.8837 3 15.6265 3.58628 17.0615 4.61538" stroke="#00ADEF" stroke-width="2" stroke-linecap="round"/><path d="M18 5.5L21 2.5M21 2.5L18 2.5M21 2.5V5.5" stroke="#00ADEF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                    </div>
                    <h3>Premios</h3>
                    <p>Medallas individuales y trofeos de equipo para los primeros lugares de cada categor√≠a</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Swimmers Message Section -->
    <section class="swimmers-message-section">
        <div class="container">
            <div style="background: linear-gradient(135deg, #0b1039 0%, #00ADEF 100%); border-radius: 20px; padding: 50px; text-align: center; color: white; box-shadow: 0 15px 40px rgba(11, 16, 57, 0.4);">
                <h3 style="color: white; margin-bottom: 20px; font-size: 1.8em; font-weight: 600;">¬°Querido nadador: al finalizar la prueba encuentra los resultados aqu√≠</h3>
                <div style="font-size: 2.5em; margin: 20px 0;">üëá</div>
                <p style="color: #dbeafe; font-size: 1.2em; margin-bottom: 0;">B√∫scalos y comparte tus logros al mundo en tu red social favorita!</p>
            </div>
        </div>
    </section>

    <!-- Results Section -->
    <section class="results-section" id="resultados">
        <div class="container">
            <h2 class="section-title">Resultados por Pruebas</h2>
            
            <!-- Search Container for Pruebas -->
            <div class="search-container">
                <div class="search-box">
                    <span class="search-icon">üîç</span>
                    <input type="text" class="search-input" id="searchPruebas" placeholder="Buscar participante por nombre...">
                    <button class="clear-search" onclick="clearSearch('searchPruebas')" style="display: none;">‚úï</button>
                </div>
                <div class="search-results-info" id="searchResultsPruebas"></div>
            </div>
            
            <div class="results-container">
                <div class="last-update">
                    √öltima actualizaci√≥n: <span class="time" id="lastUpdateTime">Cargando...</span>
                </div>
                
                <div class="tabs">
                    <button class="tab-button active" onclick="openTab(event, '50m-libre-femenino')">50 m Libre Femenino</button>
                    <button class="tab-button" onclick="openTab(event, '50m-libre-masculino')">50 m Libre Masculino</button>
                    <button class="tab-button" onclick="openTab(event, '100m-libre-femenino')">100 m Libre Femenino</button>
                    <button class="tab-button" onclick="openTab(event, '100m-libre-masculino')">100 m Libre Masculino</button>
                    <button class="tab-button" onclick="openTab(event, '200m-libre-femenino')">200 m Libre Femenino</button>
                    <button class="tab-button" onclick="openTab(event, '200m-libre-masculino')">200 m Libre Masculino</button>
                    <button class="tab-button" onclick="openTab(event, '4x50m-libre-femenino')">4x50 m Libre Femenino</button>
                    <button class="tab-button" onclick="openTab(event, '4x50m-libre-masculino')">4x50 m Libre Masculino</button>
                </div>
                <!-- Pesta√±a 50 m Libre Femenino -->
                <div id="50m-libre-femenino" class="tab-content active">
                    <h3>üèä‚Äç‚ôÄÔ∏è 50 m Libre Femenino - Resultados Oficiales</h3>
                    <table class="results-table" id="resultsTableFem">
                        <thead>
                            <tr>
                                <th>Pos.</th>
                                <th>Nadadora</th>
                                <th>Equipo</th>
                                <th>Edad</th>
                                <th>Categor√≠a</th>
                                <th>Tiempo Final</th>
                                <th>Puntos</th>
                                <th>Compartir</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="loading-row">
                                <td colspan="8" style="text-align: center; padding: 40px; color: #a5a5a5;">
                                    üîÑ Cargando datos desde Google Sheets...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <!-- Pesta√±a 50 m Libre Masculino -->
                <div id="50m-libre-masculino" class="tab-content">
                    <h3>üèä‚Äç‚ôÇÔ∏è 50 m Libre Masculino - Resultados Oficiales</h3>
                    <table class="results-table" id="resultsTableMas">
                        <thead>
                            <tr>
                                <th>Pos.</th>
                                <th>Nadador</th>
                                <th>Equipo</th>
                                <th>Edad</th>
                                <th>Categor√≠a</th>
                                <th>Tiempo Final</th>
                                <th>Puntos</th>
                                <th>Compartir</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="loading-row">
                                <td colspan="8" style="text-align: center; padding: 40px; color: #a5a5a5;">
                                    üîÑ Cargando datos desde Google Sheets...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <!-- Pesta√±a 100 m Libre Femenino -->
                <div id="100m-libre-femenino" class="tab-content">
                    <h3>üèä‚Äç‚ôÄÔ∏è 100 m Libre Femenino - Resultados Oficiales</h3>
                    <table class="results-table" id="resultsTable100mFem">
                        <thead>
                            <tr>
                                <th>Pos.</th>
                                <th>Nadadora</th>
                                <th>Equipo</th>
                                <th>Edad</th>
                                <th>Categor√≠a</th>
                                <th>Tiempo Final</th>
                                <th>Puntos</th>
                                <th>Compartir</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="loading-row">
                                <td colspan="8" style="text-align: center; padding: 40px; color: #a5a5a5;">
                                    üîÑ Cargando datos desde Google Sheets...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <!-- Pesta√±a 100 m Libre Masculino -->
                <div id="100m-libre-masculino" class="tab-content">
                    <h3>üèä‚Äç‚ôÇÔ∏è 100 m Libre Masculino - Resultados Oficiales</h3>
                    <table class="results-table" id="resultsTable100mMas">
                        <thead>
                            <tr>
                                <th>Pos.</th>
                                <th>Nadador</th>
                                <th>Equipo</th>
                                <th>Edad</th>
                                <th>Categor√≠a</th>
                                <th>Tiempo Final</th>
                                <th>Puntos</th>
                                <th>Compartir</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="loading-row">
                                <td colspan="8" style="text-align: center; padding: 40px; color: #a5a5a5;">
                                    üîÑ Cargando datos desde Google Sheets...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <!-- Pesta√±a 200 m Libre Femenino -->
                <div id="200m-libre-femenino" class="tab-content">
                    <h3>üèä‚Äç‚ôÄÔ∏è 200 m Libre Femenino - Resultados Oficiales</h3>
                    <table class="results-table" id="resultsTable200mFem">
                        <thead>
                            <tr>
                                <th>Pos.</th>
                                <th>Nadadora</th>
                                <th>Equipo</th>
                                <th>Edad</th>
                                <th>Categor√≠a</th>
                                <th>Tiempo Final</th>
                                <th>Puntos</th>
                                <th>Compartir</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="loading-row">
                                <td colspan="8" style="text-align: center; padding: 40px; color: #a5a5a5;">
                                    üîÑ Cargando datos desde Google Sheets...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <!-- Pesta√±a 200 m Libre Masculino -->
                <div id="200m-libre-masculino" class="tab-content">
                    <h3>üèä‚Äç‚ôÇÔ∏è 200 m Libre Masculino - Resultados Oficiales</h3>
                    <table class="results-table" id="resultsTable200mMas">
                        <thead>
                            <tr>
                                <th>Pos.</th>
                                <th>Nadador</th>
                                <th>Equipo</th>
                                <th>Edad</th>
                                <th>Categor√≠a</th>
                                <th>Tiempo Final</th>
                                <th>Puntos</th>
                                <th>Compartir</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="loading-row">
                                <td colspan="8" style="text-align: center; padding: 40px; color: #a5a5a5;">
                                    üîÑ Cargando datos desde Google Sheets...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <!-- Pesta√±a 4x50 m Libre Femenino -->
                <div id="4x50m-libre-femenino" class="tab-content">
                    <h3>üèä‚Äç‚ôÄÔ∏è 4x50 m Libre Femenino - Resultados Oficiales</h3>
                    <table class="results-table" id="resultsTable4x50mFem">
                        <thead>
                            <tr>
                                <th>Pos.</th>
                                <th>Nadadora</th>
                                <th>Equipo</th>
                                <th>Edad</th>
                                <th>Categor√≠a</th>
                                <th>Tiempo Final</th>
                                <th>Puntos</th>
                                <th>Compartir</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="loading-row">
                                <td colspan="8" style="text-align: center; padding: 40px; color: #a5a5a5;">
                                    üîÑ Cargando datos desde Google Sheets...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <!-- Pesta√±a 4x50 m Libre Masculino -->
                <div id="4x50m-libre-masculino" class="tab-content">
                    <h3>üèä‚Äç‚ôÇÔ∏è 4x50 m Libre Masculino - Resultados Oficiales</h3>
                    <table class="results-table" id="resultsTable4x50mMas">
                        <thead>
                            <tr>
                                <th>Pos.</th>
                                <th>Nadador</th>
                                <th>Equipo</th>
                                <th>Edad</th>
                                <th>Categor√≠a</th>
                                <th>Tiempo Final</th>
                                <th>Puntos</th>
                                <th>Compartir</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="loading-row">
                                <td colspan="8" style="text-align: center; padding: 40px; color: #a5a5a5;">
                                    üîÑ Cargando datos desde Google Sheets...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>

    <!-- Gender Results Section -->
    <section class="results-section">
        <div class="container">
            <h2 class="section-title">Resultados por G√©nero</h2>
            
            <!-- Search Container for Gender -->
            <div class="search-container">
                <div class="search-box">
                    <span class="search-icon">üîç</span>
                    <input type="text" class="search-input" id="searchGender" placeholder="Buscar participante por nombre...">
                    <button class="clear-search" onclick="clearSearch('searchGender')" style="display: none;">‚úï</button>
                </div>
                <div class="search-results-info" id="searchResultsGender"></div>
            </div>
            
            <div class="results-container">
                <div class="last-update">
                    √öltima actualizaci√≥n: <span class="time" id="lastUpdateTimeGender">Cargando...</span>
                </div>
                
                <div class="tabs">
                    <button class="tab-button active" onclick="openGenderTab(event, 'masculino-general')">üèä‚Äç‚ôÇÔ∏è Masculino</button>
                    <button class="tab-button" onclick="openGenderTab(event, 'femenino-general')">üèä‚Äç‚ôÄÔ∏è Femenino</button>
                </div>

                <!-- Pesta√±a Masculino General -->
                <div id="masculino-general" class="tab-content active">
                    <h3>üèä‚Äç‚ôÇÔ∏è Clasificaci√≥n General Masculina</h3>
                    <table class="results-table" id="resultsTableMasculinoGeneral">
                        <thead>
                            <tr>
                                <th>Lugar</th>
                                <th>Atleta</th>
                                <th>Equipo</th>
                                <th>Edad</th>
                                <th>Categor√≠a</th>
                                <th>Puntos Totales</th>
                                <th>P. 200m Libre</th>
                                <th>P. 50m Libre</th>
                                <th>P. 100m Libre</th>
                                <th>Compartir</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="loading-row">
                                <td colspan="9" style="text-align: center; padding: 40px; color: #a5a5a5;">
                                    üîÑ Cargando clasificaci√≥n masculina...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Pesta√±a Femenino General -->
                <div id="femenino-general" class="tab-content">
                    <h3>üèä‚Äç‚ôÄÔ∏è Clasificaci√≥n General Femenina</h3>
                    <table class="results-table" id="resultsTableFemeninoGeneral">
                        <thead>
                            <tr>
                                <th>Lugar</th>
                                <th>Atleta</th>
                                <th>Equipo</th>
                                <th>Edad</th>
                                <th>Categor√≠a</th>
                                <th>Puntos Totales</th>
                                <th>P. 200m Libre</th>
                                <th>P. 50m Libre</th>
                                <th>P. 100m Libre</th>
                                <th>Compartir</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="loading-row">
                                <td colspan="9" style="text-align: center; padding: 40px; color: #a5a5a5;">
                                    üîÑ Cargando clasificaci√≥n femenina...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>

    <!-- Team Results Section -->
    <section class="results-section">
        <div class="container">
            <h2 class="section-title">Resultados por Equipos</h2>
            <div class="results-container">
                <div class="last-update">
                    √öltima actualizaci√≥n: <span class="time" id="lastUpdateTimeTeams">Cargando...</span>
                </div>
                
                <h3 style="color: #0b1039; margin-bottom: 30px; text-align: center; font-size: 1.8em; font-weight: 600;">
                    üèÜ Clasificaci√≥n General por Equipos
                </h3>
                
                <table class="results-table" id="resultsTableTeams">
                    <thead>
                        <tr>
                            <th>Lugar</th>
                            <th>Equipo</th>
                            <th>Puntos Totales</th>
                            <th>Puntos Femeninos</th>
                            <th>Puntos Masculinos</th>
                            <th>Compartir</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="loading-row">
                            <td colspan="6" style="text-align: center; padding: 40px; color: #a5a5a5;">
                                üîÑ Cargando clasificaci√≥n de equipos...
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </section>

    <!-- Download Results Section -->
    <section class="results-section" style="background: #f8f9fa; border-top: 3px solid #0b1039;">
        <div class="container">
            <h2 class="section-title" style="color: #0b1039;">üìÑ Descargar Resultados</h2>
            <div class="download-container" style="text-align: center; padding: 40px 20px;">
                <div class="download-info" style="margin-bottom: 30px;">
                    <p style="font-size: 1.2em; color: #666; max-width: 600px; margin: 0 auto;">
                        Descarga un reporte completo en PDF con todos los resultados del evento, 
                        incluyendo clasificaciones por pruebas, g√©nero y equipos.
                    </p>
                </div>
                <button id="downloadPdfBtn" class="download-btn" style="
                    background: linear-gradient(135deg, #0b1039, #1a2470);
                    color: white;
                    border: none;
                    padding: 15px 40px;
                    font-size: 1.1em;
                    font-weight: 600;
                    border-radius: 50px;
                    cursor: pointer;
                    transition: all 0.3s ease;
                    box-shadow: 0 5px 20px rgba(11, 16, 57, 0.3);
                    display: inline-flex;
                    align-items: center;
                    gap: 10px;
                " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 8px 25px rgba(11, 16, 57, 0.4)'" 
                   onmouseout="this.style.transform='translateY(0px)'; this.style.boxShadow='0 5px 20px rgba(11, 16, 57, 0.3)'">
                    <span style="font-size: 1.2em;">üìã</span>
                    Descargar Resultados PDF
                </button>
                
                <div id="pdfStatus" style="margin-top: 20px; display: none;">
                    <p style="color: #0b1039; font-weight: 500;">
                        <span style="font-size: 1.2em;">‚è≥</span> Generando PDF...
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- Sponsors Section -->
    <section class="sponsors-section" id="patrocinadores">
        <div class="container">
            <h2 class="section-title">Nuestros Patrocinadores</h2>
            <div class="sponsors-grid">
                <a href="#" target="_blank" class="sponsor-card">
                    <div class="sponsor-logo"><img src="https://via.placeholder.com/200x80/FAFAFA/CCCCCC?text=Sponsor+1" alt="Patrocinador 1"></div>
                    <div class="sponsor-name">Empresa Patrocinadora 1</div>
                </a>
                <a href="#" target="_blank" class="sponsor-card">
                    <div class="sponsor-logo"><img src="https://via.placeholder.com/200x80/FAFAFA/CCCCCC?text=Sponsor+2" alt="Patrocinador 2"></div>
                    <div class="sponsor-name">Empresa Patrocinadora 2</div>
                </a>
                <a href="#" target="_blank" class="sponsor-card">
                    <div class="sponsor-logo"><img src="https://via.placeholder.com/200x80/FAFAFA/CCCCCC?text=Sponsor+3" alt="Patrocinador 3"></div>
                    <div class="sponsor-name">Empresa Patrocinadora 3</div>
                </a>
                <a href="#" target="_blank" class="sponsor-card">
                    <div class="sponsor-logo"><img src="https://via.placeholder.com/200x80/FAFAFA/CCCCCC?text=Sponsor+4" alt="Patrocinador 4"></div>
                    <div class="sponsor-name">Empresa Patrocinadora 4</div>
                </a>
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="cta-section">
        <div class="container">
            <h2>¬øListo para competir?</h2>
            <p>√önete a los mejores nadadores en esta emocionante competencia, en esta IV versi√≥n del Championship Master Swimming organizada por los Clubes Deportivos AQUATEN y ELYANASNATACION</p>
            <a href="#" class="cta-button">M√°s Informaci√≥n</a>
        </div>
    </section>
    
    <!-- Contact Section -->
    <section class="contact-section" id="contacto">
        <div class="container">
            <h2 class="section-title">Contacto</h2>
            <div class="contact-grid">
                <!-- WhatsApp Card -->
                <a href="https://wa.me/573196583574" target="_blank" class="contact-card-link">
                    <div class="sticker-icon">
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M16.75 13.96C16.41 13.79 15.31 13.24 15.08 13.15C14.86 13.06 14.7 13.02 14.54 13.28C14.38 13.55 13.91 14.11 13.75 14.28C13.59 14.45 13.43 14.47 13.16 14.3C12.89 14.13 12.06 13.85 11.07 12.99C10.29 12.3 9.73 11.48 9.59 11.21C9.45 10.94 9.56 10.81 9.7 10.67C9.83 10.53 9.99 10.33 10.13 10.18C10.27 10.03 10.32 9.9 10.42 9.73C10.52 9.56 10.47 9.4 10.39 9.27C10.31 9.14 9.85 7.97 9.66 7.52C9.47 7.07 9.28 7.13 9.14 7.12H8.62C8.42 7.12 8.13 7.19 7.89 7.43C7.65 7.67 6.96 8.31 6.96 9.56C6.96 10.81 7.92 12.01 8.06 12.18C8.2 12.35 9.85 14.8 12.29 15.76C14.73 16.72 14.73 16.34 15.13 16.3C15.53 16.26 16.54 15.68 16.75 15.13C16.96 14.58 16.96 14.12 16.88 13.96H16.75Z" stroke="#0b5079" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><path d="M12.04 21.82C17.56 21.82 22 17.38 22 11.86C22 6.34 17.56 1.9 12.04 1.9C6.52 1.9 2.08 6.34 2.08 11.86C2.08 14.13 2.84 16.24 4.12 17.9L2.56 21.34L6.17 19.95C7.73 21.13 9.79 21.82 12.04 21.82Z" stroke="#00ADEF" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
                    </div>
                    <h3>WhatsApp</h3>
                    <p>+57 319 658 3574</p>
                </a>
                <!-- Instagram Card -->
                <a href="https://www.instagram.com/aquaten.cd" target="_blank" class="contact-card-link">
                    <div class="sticker-icon">
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="2" y="2" width="20" height="20" rx="5" ry="5" stroke="#00ADEF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M16 11.37C16 13.38 14.21 15 12 15C9.79 15 8 13.38 8 11.37C8 9.36 9.79 7.75 12 7.75C14.21 7.75 16 9.36 16 11.37Z" stroke="#0b5079" stroke-width="2"/><path d="M17.5 6.5H17.51" stroke="#0b5079" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
                    </div>
                    <h3>Instagram</h3>
                    <p>@AquaTEN</p>
                </a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 AquaTEN - Club Deportivo</p>
            <p>IV Championship Master Swimming - Todos los derechos reservados</p>
        </div>
    </footer>

    <script>
        // Variables globales
        let lastUpdateTime = null;
        let loadAttempts = 0;
        const MAX_ATTEMPTS = 3;

        // Configuraci√≥n
        const CONFIG = {
            API_KEY: 'AIzaSyDcUEGyS6grOV_p8Z6d9WofiFNMYQBblIk',
            SHEET_ID: '1EfjpkKEEi8rLxF9BwXCyyPHEcbBZJK71BijpUP1uEPI',
            SHEET_NAME: 'RESULTADOS',
            USE_API_KEY: true,
            // Mapeo autom√°tico de pesta√±as - detecta GIDs autom√°ticamente
            COMPETITION_SHEETS: {
                // Primera sesi√≥n: Resultados por prueba
                'resultados-por-prueba-femenino': ['FEMENINO', 'FEM'],
                '50m-libre-femenino': ['50M-FEMENINO', '50M FEMENINO', '50M-FEM', '50M FEM', '50 FEM'],
                '50m-libre-masculino': ['50M-MASCULINO', '50M MASCULINO', '50M-MAS', '50M MAS', '50 MAS'],
                '100m-libre-femenino': ['100M-FEMENINO', '100M FEMENINO', '100M-FEM', '100M FEM', '100 FEM', 'FEMENINO 100M'],
                '100m-libre-masculino': ['100M-MASCULINO', '100M MASCULINO', '100M-MAS', '100M MAS', '100 MAS', 'MASCULINO 100M'],
                '200m-libre-femenino': ['200M-FEMENINO', '200M FEMENINO', '200M-FEM', '200M FEM', '200 FEM', 'FEMENINO 200M'],
                '200m-libre-masculino': ['200M-MASCULINO', '200M MASCULINO', '200M-MAS', '200M MAS', '200 MAS', 'MASCULINO 200M'],
                '4x50m-libre-femenino': ['4X50M-FEMENINO', '4X50M FEMENINO', '4X50M-FEM', '4X50M FEM', '4X50 FEM', 'FEMENINO 4X50M'],
                '4x50m-libre-masculino': ['4X50M-MASCULINO', '4X50M MASCULINO', '4X50M-MAS', '4X50M MAS', '4X50 MAS', 'MASCULINO 4X50M'],
                // Segunda sesi√≥n: Resultado por g√©nero
                'resultados-femenino': ['RESULTADOS-FEMENINO', 'RESULTADOS FEMENINO', 'RESULTADOS FEM'],
                'resultados-masculino': ['RESULTADOS-MASCULINO', 'RESULTADOS MASCULINO', 'RESULTADOS MAS'],
                // Tercera sesi√≥n: Resultado por equipo
                'resultados-equipo': ['EQUIPO', 'EQUIPOS', 'TEAM', 'TEAMS', 'CLASIFICACION EQUIPOS', 'RESULTADOS EQUIPOS']
            }
        };

        // Elementos DOM
        const statusIndicator = document.getElementById('statusIndicator');
        const lastUpdateElement = document.getElementById('lastUpdateTime');
        const lastUpdateElementTeams = document.getElementById('lastUpdateTimeTeams');
        const lastUpdateElementGender = document.getElementById('lastUpdateTimeGender');
        const resultsTableTeams = document.getElementById('resultsTableTeams');
        const resultsTableMasculinoGeneral = document.getElementById('resultsTableMasculinoGeneral');
        const resultsTableFemeninoGeneral = document.getElementById('resultsTableFemeninoGeneral');
        
        // Mapeo de elementos DOM por competencia
        const COMPETITION_TABLES = {
            // Primera sesi√≥n: Resultados por prueba
            'resultados-por-prueba-femenino': document.getElementById('resultsTableFem'),
            '50m-libre-femenino': document.getElementById('resultsTableFem'),
            '50m-libre-masculino': document.getElementById('resultsTableMas'),
            '100m-libre-femenino': document.getElementById('resultsTable100mFem'),
            '100m-libre-masculino': document.getElementById('resultsTable100mMas'),
            '200m-libre-femenino': document.getElementById('resultsTable200mFem'),
            '200m-libre-masculino': document.getElementById('resultsTable200mMas'),
            '4x50m-libre-femenino': document.getElementById('resultsTable4x50mFem'),
            '4x50m-libre-masculino': document.getElementById('resultsTable4x50mMas'),
            // Segunda sesi√≥n: Resultado por g√©nero
            'resultados-femenino': resultsTableFemeninoGeneral,
            'resultados-masculino': resultsTableMasculinoGeneral,
            // Tercera sesi√≥n: Resultado por equipo
            'resultados-equipo': resultsTableTeams,
            // Compatibilidad con nombres antiguos
            'equipos': resultsTableTeams,
            'masculino-general': resultsTableMasculinoGeneral,
            'femenino-general': resultsTableFemeninoGeneral
        };

        // Funci√≥n para actualizar el indicador de estado
        function updateStatus(type, message) {
            statusIndicator.className = `status-indicator status-${type}`;
            statusIndicator.textContent = message;
            console.log(`üì± Status: ${type} - ${message}`);
            
            if (type === 'success' || type === 'error') {
                setTimeout(() => {
                    statusIndicator.style.opacity = '0';
                    setTimeout(() => {
                        statusIndicator.style.display = 'none';
                    }, 300);
                }, 5000); // Aumentado de 3000 a 5000 para ver mejor los mensajes
            }
        }

        // Funci√≥n para actualizar tiempo de √∫ltima actualizaci√≥n
        function updateLastUpdateTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('es-CO', {
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                timeZone: 'America/Bogota'
            });
            lastUpdateElement.textContent = timeString;
            lastUpdateTime = now;
        }

        // Parser CSV mejorado
        function parseCSV(csvText) {
            const rows = [];
            const lines = csvText.split('\n');
            
            for (let line of lines) {
                if (!line.trim()) continue;
                
                const cols = [];
                let currentCol = '';
                let inQuotes = false;
                
                for (let i = 0; i < line.length; i++) {
                    const char = line[i];
                    const nextChar = line[i + 1];
                    
                    if (char === '"') {
                        if (inQuotes && nextChar === '"') {
                            currentCol += '"';
                            i++;
                        } else {
                            inQuotes = !inQuotes;
                        }
                    } else if (char === ',' && !inQuotes) {
                        cols.push(currentCol.trim());
                        currentCol = '';
                    } else {
                        currentCol += char;
                    }
                }
                
                cols.push(currentCol.trim());
                
                if (cols.some(cell => cell && cell.trim() !== '')) {
                    rows.push(cols);
                }
            }
            
            return rows;
        }

        // Funci√≥n para obtener informaci√≥n de todas las pesta√±as del Google Sheet autom√°ticamente
        async function getSheetInfo() {
            try {
                const url = `https://sheets.googleapis.com/v4/spreadsheets/${CONFIG.SHEET_ID}?key=${CONFIG.API_KEY}`;
                const response = await fetch(url);
                if (response.ok) {
                    const data = await response.json();
                    return data.sheets.map(sheet => ({
                        title: sheet.properties.title,
                        gid: sheet.properties.sheetId
                    }));
                }
            } catch (error) {
                console.log('‚ö†Ô∏è No se pudo obtener info autom√°tica de pesta√±as:', error.message);
            }
            return null;
        }

        // Funci√≥n para encontrar el GID de una competencia espec√≠fica
        function findSheetGid(sheetInfo, competitionKey) {
            if (!sheetInfo) return detectedGids[competitionKey] || null;
            
            // Si ya tenemos el GID en cache, usarlo
            if (detectedGids[competitionKey]) {
                return detectedGids[competitionKey];
            }
            
            console.log(`üîç Buscando pesta√±a para: ${competitionKey}`);
            console.log(`üìã Pesta√±as disponibles en Google Sheet:`, sheetInfo.map(s => s.title));
            
            const possibleNames = CONFIG.COMPETITION_SHEETS[competitionKey] || [];
            console.log(`üéØ Nombres posibles para ${competitionKey}:`, possibleNames);
            
            // B√∫squeda m√°s inteligente
            for (const possibleName of possibleNames) {
                const sheet = sheetInfo.find(s => {
                    const sheetTitle = s.title.toUpperCase().trim();
                    const searchName = possibleName.toUpperCase().trim();
                    
                    // Coincidencia exacta
                    if (sheetTitle === searchName) return true;
                    
                    // Contiene el nombre
                    if (sheetTitle.includes(searchName) || searchName.includes(sheetTitle)) return true;
                    
                    // B√∫squeda por palabras clave
                    if (competitionKey.includes('masculino') || competitionKey.includes('mas')) {
                        if (sheetTitle.includes('MASCULINO') || sheetTitle.includes('MAS') || 
                            sheetTitle.includes('MASC') || sheetTitle.includes('HOMBRES')) {
                            
                            // Verificar tambi√©n la distancia
                            if (competitionKey.includes('50m') && (sheetTitle.includes('50') || !sheetTitle.match(/\d/))) return true;
                            if (competitionKey.includes('100m') && sheetTitle.includes('100')) return true;
                            if (competitionKey.includes('200m') && sheetTitle.includes('200')) return true;
                            if (competitionKey.includes('4x50m') && (sheetTitle.includes('4X50') || sheetTitle.includes('4 X 50'))) return true;
                        }
                    }
                    
                    return false;
                });
                
                if (sheet) {
                    console.log(`‚úÖ Encontrada pesta√±a para ${competitionKey}: "${sheet.title}" (GID: ${sheet.gid})`);
                    // Guardar en cache para futuros usos
                    detectedGids[competitionKey] = sheet.gid;
                    return sheet.gid;
                }
            }
            
            console.log(`‚ö†Ô∏è No se encontr√≥ pesta√±a para ${competitionKey}`);
            console.log(`üí° Intenta renombrar alguna pesta√±a para que contenga: ${possibleNames.slice(0, 3).join(', ')}`);
            return null;
        }

        // Funci√≥n para mostrar los GIDs detectados (para debugging)
        function logDetectedGids() {
            console.log('üìã GIDs detectados autom√°ticamente:');
            Object.entries(detectedGids).forEach(([key, gid]) => {
                console.log(`  ${key}: ${gid}`);
            });
        }

        // M√©todo principal para cargar datos desde Google Sheets (usando l√≥gica exitosa del test)
        async function loadSheetData() {
            loadAttempts++;
            updateStatus('loading', 'üîÑ Cargando resultados...');
            
            try {
                console.log('üîç Obteniendo lista de pesta√±as...');
                const sheetInfo = await getSheetInfo();
                
                if (!sheetInfo) {
                    console.log('‚ùå No se pudo obtener informaci√≥n de las pesta√±as');
                    throw new Error('No se pudo acceder a las pesta√±as del Google Sheet');
                }
                
                console.log('üìã Pesta√±as encontradas:');
                sheetInfo.forEach(sheet => {
                    console.log(`  - "${sheet.title}" (GID: ${sheet.gid})`);
                });
                
                let hasData = false;
                
                // Definir competencias a buscar con palabras clave m√°s flexibles
                const competitions = {
                    // Resultados por prueba FEMENINO - mapea a la primera tabla que aparece
                    'resultados-por-prueba-femenino': {
                        keywords: ['FEMENINO'],
                        alternativeNames: ['FEMENINO', 'FEM'],
                        tableId: 'resultsTableFem',
                        genderColumn: 'Nadadora'
                    },
                    // 50M Femenino y Masculino
                    '50m-libre-femenino': {
                        keywords: ['50M', 'FEMENINO'],
                        alternativeNames: ['50M-FEMENINO', '50M FEMENINO', '50M-FEM', '50M FEM'],
                        tableId: 'resultsTable50mFem',
                        genderColumn: 'Nadadora'
                    },
                    '50m-libre-masculino': {
                        keywords: ['50M', 'MASCULINO'],
                        alternativeNames: ['50M-MASCULINO', '50M MASCULINO', '50M-MAS', '50M MAS'],
                        tableId: 'resultsTableMas',
                        genderColumn: 'Nadador'
                    },
                    // 100M Femenino y Masculino
                    '100m-libre-femenino': {
                        keywords: ['100M', 'FEMENINO'],
                        alternativeNames: ['100M-FEMENINO', '100M FEMENINO', '100M-FEM', '100M FEM'],
                        tableId: 'resultsTable100mFem',
                        genderColumn: 'Nadadora'
                    },
                    '100m-libre-masculino': {
                        keywords: ['100M', 'MASCULINO'],
                        alternativeNames: ['100M-MASCULINO', '100M MASCULINO', '100M-MAS', '100M MAS'],
                        tableId: 'resultsTable100mMas',
                        genderColumn: 'Nadador'
                    },
                    // 200M Femenino y Masculino
                    '200m-libre-femenino': {
                        keywords: ['200M', 'FEMENINO'],
                        alternativeNames: ['200M-FEMENINO', '200M FEMENINO', '200M-FEM', '200M FEM'],
                        tableId: 'resultsTable200mFem',
                        genderColumn: 'Nadadora'
                    },
                    '200m-libre-masculino': {
                        keywords: ['200M', 'MASCULINO'],
                        alternativeNames: ['200M-MASCULINO', '200M MASCULINO', '200M-MAS', '200M MAS'],
                        tableId: 'resultsTable200mMas',
                        genderColumn: 'Nadador'
                    },
                    // 4X50M Femenino y Masculino
                    '4x50m-libre-femenino': {
                        keywords: ['4X50M', 'FEMENINO'],
                        alternativeNames: ['4X50M-FEMENINO', '4X50M FEMENINO', '4X50M-FEM', '4X50M FEM'],
                        tableId: 'resultsTable4x50mFem',
                        genderColumn: 'Nadadora'
                    },
                    '4x50m-libre-masculino': {
                        keywords: ['4X50M', 'MASCULINO'],
                        alternativeNames: ['4X50M-MASCULINO', '4X50M MASCULINO', '4X50M-MAS', '4X50M MAS'],
                        tableId: 'resultsTable4x50mMas',
                        genderColumn: 'Nadador'
                    },
                    // Resultados por g√©nero
                    'resultados-femenino': {
                        keywords: ['RESULTADOS', 'FEMENINO'],
                        alternativeNames: ['RESULTADOS-FEMENINO', 'RESULTADOS FEMENINO'],
                        tableId: 'resultsTableFemeninoGeneral',
                        genderColumn: 'Nadadora'
                    },
                    'resultados-masculino': {
                        keywords: ['RESULTADOS', 'MASCULINO'],
                        alternativeNames: ['RESULTADOS-MASCULINO', 'RESULTADOS MASCULINO'],
                        tableId: 'resultsTableMasculinoGeneral',
                        genderColumn: 'Nadador'
                    },
                    // Resultados por equipo
                    'resultados-equipo': {
                        keywords: ['EQUIPO'],
                        alternativeNames: ['EQUIPO', 'EQUIPOS'],
                        tableId: 'resultsTableTeams',
                        genderColumn: 'Equipo'
                    }
                };
                
                // Buscar y cargar cada competencia con l√≥gica de b√∫squeda inteligente
                for (const [competitionKey, config] of Object.entries(competitions)) {
                    console.log(`üîç Buscando coincidencias para ${competitionKey}...`);
                    console.log(`üéØ Palabras clave: ${config.keywords.join(', ')}`);
                    console.log(`üîç Nombres alternativos: ${config.alternativeNames.join(', ')}`);
                    
                    let foundSheet = null;
                    
                    // 1. Primera b√∫squeda: coincidencia exacta con nombres alternativos
                    foundSheet = sheetInfo.find(sheet => {
                        const title = sheet.title.toUpperCase().trim();
                        const exactMatch = config.alternativeNames.some(altName => 
                            title === altName.toUpperCase().trim()
                        );
                        if (exactMatch) {
                            console.log(`‚úÖ Coincidencia exacta encontrada: "${sheet.title}"`);
                        }
                        return exactMatch;
                    });
                    
                    // 2. Segunda b√∫squeda: pesta√±a que contenga todas las palabras clave
                    if (!foundSheet) {
                        foundSheet = sheetInfo.find(sheet => {
                            const title = sheet.title.toUpperCase();
                            const hasAllKeywords = config.keywords.every(keyword => 
                                title.includes(keyword.toUpperCase())
                            );
                            if (hasAllKeywords) {
                                console.log(`‚úÖ Coincidencia por palabras clave: "${sheet.title}" contiene todas las palabras clave`);
                            }
                            return hasAllKeywords;
                        });
                    }
                    
                    // 3. Tercera b√∫squeda: coincidencia parcial con nombres alternativos
                    if (!foundSheet) {
                        foundSheet = sheetInfo.find(sheet => {
                            const title = sheet.title.toUpperCase();
                            const partialMatch = config.alternativeNames.some(altName => 
                                title.includes(altName.toUpperCase()) || altName.toUpperCase().includes(title)
                            );
                            if (partialMatch) {
                                console.log(`‚úÖ Coincidencia parcial encontrada: "${sheet.title}"`);
                            }
                            return partialMatch;
                        });
                    }
                    
                    // 4. Cuarta b√∫squeda: al menos una palabra clave para casos especiales
                    if (!foundSheet && config.keywords.length === 1) {
                        foundSheet = sheetInfo.find(sheet => {
                            const title = sheet.title.toUpperCase();
                            const hasKeyword = config.keywords.some(keyword => 
                                title.includes(keyword.toUpperCase())
                            );
                            if (hasKeyword) {
                                console.log(`‚úÖ Coincidencia simple encontrada: "${sheet.title}" contiene palabra clave`);
                            }
                            return hasKeyword;
                        });
                    }
                    
                    if (foundSheet) {
                        console.log(`üìÑ Cargando datos de "${foundSheet.title}" (GID: ${foundSheet.gid})...`);
                        const data = await loadSheetByGid(foundSheet.gid);
                        
                        if (data && data.length > 0) {
                            console.log(`‚úÖ Datos cargados: ${data.length} filas`);
                            
                            const table = document.getElementById(config.tableId);
                            if (table) {
                                console.log(`üîÑ Actualizando tabla ${competitionKey}...`);
                                
                                // Usar funci√≥n espec√≠fica para tabla de equipos
                                if (competitionKey === 'resultados-equipo' || config.tableId === 'resultsTableTeams') {
                                    updateTeamTableContent(table, data);
                                } else {
                                    updateTableContent(table, data, config.genderColumn);
                                }
                                
                                table.classList.remove('loading');
                                hasData = true;
                                console.log(`‚úÖ Tabla ${competitionKey} actualizada`);
                            }
                        } else {
                            console.log(`‚ùå No se pudieron cargar datos de "${foundSheet.title}"`);
                        }
                    } else {
                        console.log(`‚ö†Ô∏è No se encontr√≥ pesta√±a para ${competitionKey}`);
                        console.log(`üí° Palabras clave buscadas:`, config.keywords);
                        console.log(`üìã Pesta√±as disponibles:`, sheetInfo.map(s => s.title));
                        
                        // Mostrar mensaje espec√≠fico en la tabla
                        const table = document.getElementById(config.tableId);
                        if (table) {
                            table.innerHTML = `<tr><td colspan="8" style="text-align: center; padding: 20px; color: #666;">
                                No se encontr√≥ pesta√±a para ${competitionKey}<br>
                                <small>Palabras clave: ${config.keywords.join(', ')}</small>
                            </td></tr>`;
                            table.classList.remove('loading');
                        }
                    }
                }
                
                // Actualizar estado final (siempre completar, aunque solo se carguen algunas pesta√±as)
                if (hasData) {
                    updateStatus('success', '‚úÖ Resultados actualizados');
                    updateLastUpdateTime();
                    
                    // Actualizar tambi√©n tiempo de g√©nero si se cargaron tablas de g√©nero
                    if (lastUpdateElementGender) {
                        const now = new Date();
                        const timeString = now.toLocaleTimeString('es-CO', {
                            hour: '2-digit',
                            minute: '2-digit',
                            second: '2-digit',
                            timeZone: 'America/Bogota'
                        });
                        lastUpdateElementGender.textContent = timeString;
                    }
                    
                    loadAttempts = 0;
                    console.log('üéâ ¬°Carga autom√°tica completada exitosamente!');
                } else {
                    updateStatus('warning', '‚ö†Ô∏è No se encontraron pesta√±as coincidentes');
                    updateLastUpdateTime();
                    loadAttempts = 0;
                    console.log('‚ö†Ô∏è No se pudieron cargar datos - verificar nombres de pesta√±as');
                    // No hacer throw para evitar que se quede cargando infinitamente
                }
                
            } catch (error) {
                console.error('‚ùå Error cargando datos:', error);
                
                if (loadAttempts < MAX_ATTEMPTS) {
                    updateStatus('loading', `üîÑ Reintentando... (${loadAttempts}/${MAX_ATTEMPTS})`);
                    setTimeout(() => loadSheetData(), 5000);
                } else {
                    updateStatus('error', '‚ùå Error cargando datos');
                    showErrorFallback();
                }
            }
        }

        // Funci√≥n fallback con GIDs conocidos y auto-detectados
        function getFallbackGid(competitionKey) {
            const fallbackGids = {
                '50m-libre-femenino': '0',      // Pesta√±a FEMENINO
                '50m-libre-masculino': '2016301649', // Pesta√±a MASCULINO (o 50M-MASCULINO)
                // Los siguientes se detectar√°n autom√°ticamente cuando cargue la p√°gina
                '100m-libre-femenino': null,   // Se buscar√° autom√°ticamente en 100M-FEMENINO
                '100m-libre-masculino': null,  // Se buscar√° autom√°ticamente en 100M-MASCULINO
                '200m-libre-femenino': null,   // Se buscar√° autom√°ticamente en 200M-FEMENINO
                '200m-libre-masculino': null,  // Se buscar√° autom√°ticamente en 200M-MASCULINO
                '4x50m-libre-femenino': null,  // Se buscar√° autom√°ticamente en 4X50M-FEMENINO
                '4x50m-libre-masculino': null  // Se buscar√° autom√°ticamente en 4X50M-MASCULINO
            };
            return fallbackGids[competitionKey] || null;
        }

        // Cache de GIDs detectados autom√°ticamente
        let detectedGids = {};

        // Funci√≥n para cargar una hoja espec√≠fica por GID
        async function loadSheetByGid(gid) {
            let data = null;
            
            console.log(`üìÑ Cargando datos con GID: ${gid}`);
            
            try {
                const url = `https://docs.google.com/spreadsheets/d/${CONFIG.SHEET_ID}/export?format=csv&gid=${gid}`;
                console.log(`üìÑ URL completa: ${url}`);
                
                const response = await fetch(url);
                console.log(`üì° Respuesta HTTP: ${response.status} ${response.statusText}`);
                
                if (response.ok) {
                    const text = await response.text();
                    console.log(`üìù Tama√±o del texto recibido: ${text.length} caracteres`);
                    console.log(`üîç Primeros 200 caracteres:`, text.substring(0, 200));
                    
                    if (text && !text.includes('<!DOCTYPE')) {
                        data = parseCSV(text);
                        console.log(`‚úÖ CSV parseado con GID ${gid}: ${data.length} filas`);
                        if (data.length > 0) {
                            console.log(`üîç Primera fila (encabezados):`, data[0]);
                            console.log(`üîç Segunda fila (primer dato):`, data[1]);
                            console.log(`üîç √öltima fila:`, data[data.length - 1]);
                        }
                    } else {
                        console.warn(`‚ö†Ô∏è Respuesta parece ser HTML en lugar de CSV para GID ${gid}`);
                    }
                } else {
                    console.error(`‚ùå Error HTTP ${response.status} para GID ${gid}: ${response.statusText}`);
                }
            } catch (error) {
                console.error(`‚ùå Error cargando GID ${gid}:`, error.message);
            }
            
            return data;
        }
        
        // Funci√≥n para cargar una hoja espec√≠fica por nombre
        async function loadSheetByName(sheetName) {
            let data = null;
            
            // Intentar con API Key primero
            if (CONFIG.USE_API_KEY) {
                const ranges = [
                    `${sheetName}!A:Z`,
                    `${sheetName}!A1:Z1000`,
                    `'${sheetName}'!A:Z`,
                    `'${sheetName}'!A1:Z1000`
                ];
                
                for (const range of ranges) {
                    try {
                        const url = `https://sheets.googleapis.com/v4/spreadsheets/${CONFIG.SHEET_ID}/values/${range}?key=${CONFIG.API_KEY}`;
                        console.log(`üîç Probando rango: ${range}`);
                        
                        const response = await fetch(url, {
                            method: 'GET',
                            headers: {
                                'Accept': 'application/json',
                                'Cache-Control': 'no-cache'
                            }
                        });
                        
                        if (response.ok) {
                            const responseData = await response.json();
                            if (responseData.values && responseData.values.length > 0) {
                                data = responseData.values;
                                console.log(`‚úÖ Datos encontrados en ${sheetName}: ${data.length} filas`);
                                break;
                            }
                        } else {
                            const errorData = await response.json();
                            console.log(`‚ùå Error en ${range}:`, errorData);
                        }
                    } catch (error) {
                        console.log(`‚ùå Error en rango ${range}:`, error.message);
                    }
                }
            }
            
            // Si no hay datos con API Key, intentar CSV con gid espec√≠fico
            if (!data) {
                console.log(`üìÑ Intentando m√©todo CSV para ${sheetName}...`);
                
                // Usar los gid espec√≠ficos para cada hoja
                let gid = '0'; // Por defecto para FEMENINO
                
                if (sheetName === 'MASCULINO') {
                    gid = '2016301649'; // GID espec√≠fico para MASCULINO
                }
                
                try {
                    const url = `https://docs.google.com/spreadsheets/d/${CONFIG.SHEET_ID}/export?format=csv&gid=${gid}`;
                    console.log(`üìÑ Cargando CSV de ${sheetName} con gid=${gid}`);
                    
                    const response = await fetch(url);
                    if (response.ok) {
                        const text = await response.text();
                        if (text && !text.includes('<!DOCTYPE')) {
                            data = parseCSV(text);
                            console.log(`‚úÖ CSV parseado para ${sheetName}: ${data.length} filas`);
                            console.log(`üîç Primeras 3 filas de ${sheetName}:`, data.slice(0, 3));
                        }
                    }
                } catch (error) {
                    console.log(`‚ùå Error CSV para ${sheetName}:`, error.message);
                }
            }
            
            return data;
        }
        
        // Funci√≥n para mostrar mensaje de no datos
        function showNoDataMessage(table, message) {
            const tbody = table.querySelector('tbody');
            tbody.innerHTML = `
                <tr>
                    <td colspan="7" style="text-align: center; padding: 40px; color: #a5a5a5;">
                        ${message}
                    </td>
                </tr>`;
        }

        // Funci√≥n para actualizar la tabla de resultados (ya no se usa)
        function updateResultsTable(data) {
            // Esta funci√≥n ya no se necesita porque cargamos las hojas por separado
            console.log('‚ö†Ô∏è updateResultsTable llamada pero no deber√≠a usarse');
        }
        
        // Funci√≥n auxiliar para actualizar contenido de tabla
        function updateTableContent(table, data, swimmerLabel) {
            const tbody = table.querySelector('tbody');
            if (!tbody) return;
            
            let htmlContent = '';
            let currentCategory = '';
            
            // Detectar si es tabla de g√©nero (tiene m√°s columnas)
            const isGenderTable = table.id.includes('General') || table.id.includes('resultados');
            const colspan = isGenderTable ? "10" : "8";
            
            for (let i = 1; i < data.length; i++) {
                const row = data[i];
                if (!row || row.length === 0) continue;
                
                // Si es una fila con solo categor√≠a
                if (row.length === 1 || (row[0] && !row[1])) {
                    const categoryText = row[0].toString().trim();
                    // Verificar que sea una categor√≠a v√°lida
                    if (categoryText.match(/^(INFANTIL|JUVENIL|MAYORES|MASTER)/i)) {
                        currentCategory = categoryText;
                        htmlContent += `
                            <tr class="category-header">
                                <td colspan="${colspan}">${currentCategory}</td>
                            </tr>`;
                    }
                } else if (row.length >= 6) {
                    // Es un resultado
                    if (isGenderTable) {
                        // Para tablas de g√©nero con m√°s columnas
                        const [pos, swimmer, equipo, edad, categoria, puntosTotal, puntos50m, puntos100m, puntos200m] = row;
                        
                        // Skip si no hay nadador
                        if (!swimmer || swimmer === '-' || swimmer.toLowerCase().includes('sin participantes')) {
                            if (swimmer && swimmer.toLowerCase().includes('sin participantes')) {
                                htmlContent += `
                                    <tr>
                                        <td data-label="Pos." class="rank" style="text-align: center; color: #a5a5a5;">-</td>
                                        <td data-label="${swimmerLabel}" style="color: #a5a5a5; font-style: italic;">Sin participantes</td>
                                        <td data-label="Equipo" style="color: #a5a5a5;">-</td>
                                        <td data-label="Edad" style="color: #a5a5a5;">-</td>
                                        <td data-label="Categor√≠a" style="color: #a5a5a5;">${currentCategory}</td>
                                        <td data-label="Puntos Totales" style="color: #a5a5a5;">-</td>
                                        <td data-label="P. 50m Libre" style="color: #a5a5a5;">-</td>
                                        <td data-label="P. 100m Libre" style="color: #a5a5a5;">-</td>
                                        <td data-label="P. 200m Libre" style="color: #a5a5a5;">-</td>
                                        <td data-label="Compartir" style="color: #a5a5a5;">-</td>
                                    </tr>`;
                            }
                            continue;
                        }
                        
                        // Generar medallas para las posiciones
                        let displayPos = pos;
                        if (pos === '1' || pos === 1) displayPos = 'ü•á 1¬∞';
                        else if (pos === '2' || pos === 2) displayPos = 'ü•à 2¬∞';
                        else if (pos === '3' || pos === 3) displayPos = 'ü•â 3¬∞';
                        else if (pos && pos !== '-' && pos !== '') displayPos = `${pos}¬∞`;
                        
                        htmlContent += `
                            <tr>
                                <td data-label="Pos." class="rank">${displayPos || '-'}</td>
                                <td data-label="${swimmerLabel}">${swimmer || '-'}</td>
                                <td data-label="Equipo">${equipo || '-'}</td>
                                <td data-label="Edad">${edad || '-'}</td>
                                <td data-label="Categor√≠a">${categoria || currentCategory}</td>
                                <td data-label="Puntos Totales" class="points">${puntosTotal || '-'}</td>
                                <td data-label="P. 50m Libre" class="points">${puntos50m || '-'}</td>
                                <td data-label="P. 100m Libre" class="points">${puntos100m || '-'}</td>
                                <td data-label="P. 200m Libre" class="points">${puntos200m || '-'}</td>
                                <td data-label="Compartir" class="share-cell">
                                    <button class="share-btn" onclick="showShareOptions('${(swimmer || '').replace(/'/g, '\\\'')
                                    }', '${pos || ''}', 'N/A', '${(categoria || currentCategory || '').replace(/'/g, '\\\'')
                                    }')">üì±</button>
                                </td>
                            </tr>`;
                    } else {
                        // Para tablas de pruebas individuales - manejo m√°s robusto de columnas
                        let pos, swimmer, equipo, edad, categoria, tiempo, puntos;
                        
                        if (row.length >= 7) {
                            [pos, swimmer, equipo, edad, categoria, tiempo, puntos] = row;
                        } else if (row.length === 6) {
                            // Posible formato sin puntos o sin alguna columna
                            [pos, swimmer, equipo, edad, tiempo, puntos] = row;
                            categoria = currentCategory;
                        } else {
                            // Formato m√≠nimo
                            pos = row[0];
                            swimmer = row[1];
                            equipo = row[2] || '-';
                            edad = row[3] || '-';
                            categoria = row[4] || currentCategory;
                            tiempo = row[5] || '-';
                            puntos = row[6] || '-';
                        }
                        
                        // Skip si no hay nadador
                        if (!swimmer || swimmer === '-' || swimmer.toLowerCase().includes('sin participantes')) {
                            if (swimmer && swimmer.toLowerCase().includes('sin participantes')) {
                                htmlContent += `
                                    <tr>
                                        <td data-label="Pos." class="rank" style="text-align: center; color: #a5a5a5;">-</td>
                                        <td data-label="${swimmerLabel}" style="color: #a5a5a5; font-style: italic;">Sin participantes</td>
                                        <td data-label="Equipo" style="color: #a5a5a5;">-</td>
                                        <td data-label="Edad" style="color: #a5a5a5;">-</td>
                                        <td data-label="Categor√≠a" style="color: #a5a5a5;">${currentCategory}</td>
                                        <td data-label="Tiempo Final" style="color: #a5a5a5;">-</td>
                                        <td data-label="Puntos" style="color: #a5a5a5;">-</td>
                                        <td data-label="Compartir" style="color: #a5a5a5;">-</td>
                                    </tr>`;
                            }
                            continue;
                        }
                        
                        // Generar medallas para las posiciones
                        let displayPos = pos;
                        if (pos === '1' || pos === 1) displayPos = 'ü•á 1¬∞';
                        else if (pos === '2' || pos === 2) displayPos = 'ü•à 2¬∞';
                        else if (pos === '3' || pos === 3) displayPos = 'ü•â 3¬∞';
                        else if (pos && pos !== '-' && pos !== '') displayPos = `${pos}¬∞`;
                        
                        htmlContent += `
                            <tr>
                                <td data-label="Pos." class="rank">${displayPos || '-'}</td>
                                <td data-label="${swimmerLabel}">${swimmer || '-'}</td>
                                <td data-label="Equipo">${equipo || '-'}</td>
                                <td data-label="Edad">${edad || '-'}</td>
                                <td data-label="Categor√≠a">${categoria || currentCategory}</td>
                                <td data-label="Tiempo Final" class="time">${tiempo || '-'}</td>
                                <td data-label="Puntos" class="points">${puntos || '-'}</td>
                                <td data-label="Compartir" class="share-cell">
                                    <button class="share-btn" onclick="showShareOptions('${(swimmer || '').replace(/'/g, '\\\'')
                                    }', '${pos || ''}', '${(tiempo || '').replace(/'/g, '\\\'')
                                    }', '${(categoria || currentCategory || '').replace(/'/g, '\\\'')
                                    }')">üì±</button>
                                </td>
                            </tr>`;
                    }
                }
            }
            
            tbody.innerHTML = htmlContent || `<tr><td colspan="${colspan}" style="text-align: center;">No hay datos disponibles</td></tr>`;
        }

        // Funci√≥n auxiliar para actualizar contenido de tabla de equipos
        function updateTeamTableContent(table, data) {
            const tbody = table.querySelector('tbody');
            if (!tbody) return;
            
            let htmlContent = '';
            let mobileContent = '';
            
            for (let i = 1; i < data.length; i++) {
                const row = data[i];
                if (!row || row.length === 0) continue;
                
                // Esperar al menos 3 columnas: LUGAR, EQUIPO, PUNTOS TOTALES
                if (row.length >= 3) {
                    const [lugar, equipo, puntosTotales, puntosFemeninos, puntosMasculinos] = row;
                    
                    // Skip si no hay equipo v√°lido
                    if (!equipo || equipo === '-' || equipo.toLowerCase().includes('sin equipos')) {
                        continue;
                    }
                    
                    // Generar medallas para las posiciones
                    let displayPos = lugar;
                    if (lugar === '1' || lugar === 1) displayPos = 'ü•á 1¬∞';
                    else if (lugar === '2' || lugar === 2) displayPos = 'ü•à 2¬∞';
                    else if (lugar === '3' || lugar === 3) displayPos = 'ü•â 3¬∞';
                    else if (lugar && lugar !== '-' && lugar !== '') displayPos = `${lugar}¬∞`;
                    
                    // Contenido para tabla desktop
                    htmlContent += `
                        <tr>
                            <td data-label="Posici√≥n" class="rank">${displayPos || '-'}</td>
                            <td data-label="Equipo" style="font-weight: 600; color: #0b1039;">${equipo || '-'}</td>
                            <td data-label="Puntos Totales" class="points" style="font-weight: bold; color: #00ADEF; font-size: 1.1em;">${puntosTotales || '0'}</td>
                            <td data-label="Puntos Femeninos" class="points" style="color: #e91e63;">${puntosFemeninos || '0'}</td>
                            <td data-label="Puntos Masculinos" class="points" style="color: #2196f3;">${puntosMasculinos || '0'}</td>
                            <td data-label="Compartir" class="share-cell">
                                <button class="share-btn" onclick="showShareOptions('${(equipo || '').replace(/'/g, '\\\'')
                                }', '${lugar || ''}', 'N/A', 'Clasificaci√≥n por Equipos')">üì±</button>
                            </td>
                        </tr>`;
                    
                    // Contenido para versi√≥n m√≥vil
                    mobileContent += `
                        <div class="mobile-team-card">
                            <div class="team-position">${displayPos || '-'}</div>
                            <div class="team-name">${equipo || '-'}</div>
                            <div class="team-points">
                                <div>
                                    <div class="label">Total</div>
                                    <div class="value">${puntosTotales || '0'}</div>
                                </div>
                                <div>
                                    <div class="label">Femeninos</div>
                                    <div class="value" style="color: #e91e63;">${puntosFemeninos || '0'}</div>
                                </div>
                                <div>
                                    <div class="label">Masculinos</div>
                                    <div class="value" style="color: #2196f3;">${puntosMasculinos || '0'}</div>
                                </div>
                            </div>
                        </div>`;
                }
            }
            
            tbody.innerHTML = htmlContent || '<tr><td colspan="6" style="text-align: center;">No hay datos de equipos disponibles</td></tr>';
            
            // Crear o actualizar contenedor m√≥vil
            let mobileContainer = table.parentElement.querySelector('.mobile-teams-container');
            if (!mobileContainer) {
                mobileContainer = document.createElement('div');
                mobileContainer.className = 'mobile-teams-container';
                table.parentElement.appendChild(mobileContainer);
            }
            mobileContainer.innerHTML = mobileContent || '<div style="text-align: center; padding: 40px; color: #a5a5a5;">No hay datos de equipos disponibles</div>';
            
            // Actualizar el tiempo de √∫ltima actualizaci√≥n de equipos
            if (lastUpdateElementTeams) {
                const now = new Date();
                const timeString = now.toLocaleTimeString('es-CO', {
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit',
                    timeZone: 'America/Bogota'
                });
                lastUpdateElementTeams.textContent = timeString;
            }
        }

        // Funci√≥n auxiliar para actualizar contenido de tabla de g√©nero
        function updateGenderTableContent(table, data, genderLabel) {
            const tbody = table.querySelector('tbody');
            if (!tbody) return;
            
            let htmlContent = '';
            let currentCategory = '';
            
            for (let i = 1; i < data.length; i++) {
                const row = data[i];
                if (!row || row.length === 0) continue;
                
                // Si es una fila con solo categor√≠a (similar a updateTableContent)
                if (row.length === 1 || (row[0] && !row[1])) {
                    const categoryText = row[0].toString().trim();
                    // Verificar que sea una categor√≠a v√°lida
                    if (categoryText.match(/^(INFANTIL|JUVENIL|MAYORES|MASTER)/i)) {
                        currentCategory = categoryText;
                        htmlContent += `
                            <tr class="category-header">
                                <td colspan="9">${currentCategory}</td>
                            </tr>`;
                    }
                } else if (row.length >= 6) {
                    // Es un resultado - Esperar al menos 6 columnas: LUGAR, ATLETA, EQUIPO, EDAD, CATEGORIA, PUNTOS TOTALES
                    const [lugar, atleta, equipo, edad, categoria, puntosTotales, puntos200m, puntos50m, puntos100m] = row;
                    
                    // Skip si no hay atleta v√°lido
                    if (!atleta || atleta === '-' || atleta.toLowerCase().includes('sin atletas')) {
                        if (atleta && atleta.toLowerCase().includes('sin atletas')) {
                            htmlContent += `
                                <tr>
                                    <td data-label="Lugar" class="rank" style="text-align: center; color: #a5a5a5;">-</td>
                                    <td data-label="Atleta" style="color: #a5a5a5; font-style: italic;">Sin atletas</td>
                                    <td data-label="Equipo" style="color: #a5a5a5;">-</td>
                                    <td data-label="Edad" style="color: #a5a5a5;">-</td>
                                    <td data-label="Categor√≠a" style="color: #a5a5a5;">${currentCategory || categoria}</td>
                                    <td data-label="Puntos Totales" style="color: #a5a5a5;">-</td>
                                    <td data-label="P. 200m Libre" style="color: #a5a5a5;">-</td>
                                    <td data-label="P. 50m Libre" style="color: #a5a5a5;">-</td>
                                    <td data-label="P. 100m Libre" style="color: #a5a5a5;">-</td>
                                </tr>`;
                        }
                        continue;
                    }
                    
                    // Generar medallas para las posiciones
                    let displayPos = lugar;
                    if (lugar === '1' || lugar === 1) displayPos = 'ü•á 1¬∞';
                    else if (lugar === '2' || lugar === 2) displayPos = 'ü•à 2¬∞';
                    else if (lugar === '3' || lugar === 3) displayPos = 'ü•â 3¬∞';
                    else if (lugar && lugar !== '-' && lugar !== '') displayPos = `${lugar}¬∞`;
                    
                    htmlContent += `
                        <tr>
                            <td data-label="Lugar" class="rank">${displayPos || '-'}</td>
                            <td data-label="Atleta" style="font-weight: 600; color: #0b1039;">${atleta || '-'}</td>
                            <td data-label="Equipo">${equipo || '-'}</td>
                            <td data-label="Edad">${edad || '-'}</td>
                            <td data-label="Categor√≠a">${categoria || currentCategory}</td>
                            <td data-label="Puntos Totales" class="points" style="font-weight: bold; color: #00ADEF; font-size: 1.1em;">${puntosTotales || '0'}</td>
                            <td data-label="P. 200m Libre" class="points" style="color: #4caf50;">${puntos200m || '0'}</td>
                            <td data-label="P. 50m Libre" class="points" style="color: #ff9800;">${puntos50m || '0'}</td>
                            <td data-label="P. 100m Libre" class="points" style="color: #9c27b0;">${puntos100m || '0'}</td>
                        </tr>`;
                }
            }
            
            tbody.innerHTML = htmlContent || '<tr><td colspan="9" style="text-align: center;">No hay datos de clasificaci√≥n disponibles</td></tr>';
            
            // Actualizar el tiempo de √∫ltima actualizaci√≥n de g√©nero
            if (lastUpdateElementGender) {
                const now = new Date();
                const timeString = now.toLocaleTimeString('es-CO', {
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit',
                    timeZone: 'America/Bogota'
                });
                lastUpdateElementGender.textContent = timeString;
            }
        }

        // Funci√≥n para mostrar error con fallback
        function showErrorFallback() {
            const errorHTML = `
                <tr>
                    <td colspan="7" style="text-align: center; padding: 40px; color: #f44336;">
                        ‚ùå No se pudieron cargar los datos desde Google Sheets<br>
                        <small style="color: #a5a5a5; margin-top: 10px; display: block;">
                            Verifica que el Google Sheet sea p√∫blico o intenta recargar la p√°gina
                        </small>
                        <button onclick="retryLoad()" style="margin-top: 15px; padding: 10px 20px; background: #00ADEF; color: white; border: none; border-radius: 5px; cursor: pointer;">
                            üîÑ Reintentar
                        </button>
                    </td>
                </tr>`;
            
            // Aplicar error a todas las tablas
            Object.values(COMPETITION_TABLES).forEach(table => {
                if (table) {
                    const tbody = table.querySelector('tbody');
                    if (tbody) {
                        // Ajustar el colspan seg√∫n el tipo de tabla
                        const isTeamTable = table.id === 'resultsTableTeams';
                        const colspan = isTeamTable ? '6' : '8';
                        const adjustedErrorHTML = errorHTML.replace('colspan="7"', `colspan="${colspan}"`);
                        tbody.innerHTML = adjustedErrorHTML;
                    }
                }
            });
        }

        // Funci√≥n para reintentar carga
        function retryLoad() {
            loadAttempts = 0;
            loadSheetData();
        }

        // Funci√≥n de test espec√≠fica para 100M-FEMENINO
        async function testSpecificSheet() {
            console.log('üß™ ===== TEST ESPEC√çFICO 100M-FEMENINO =====');
            
            try {
                // 1. Obtener informaci√≥n de todas las pesta√±as
                console.log('üìã Obteniendo lista de pesta√±as...');
                const sheetInfo = await getSheetInfo();
                
                if (sheetInfo) {
                    console.log('üìã Pesta√±as encontradas:');
                    sheetInfo.forEach(sheet => {
                        console.log(`  - "${sheet.title}" (GID: ${sheet.gid})`);
                    });
                    
                    // 2. Buscar coincidencias para 100m-femenino
                    console.log('üîç Buscando coincidencias para 100M-FEMENINO...');
                    const possibleNames = ['100M-FEMENINO', '100M FEMENINO', '100m-femenino', '100MFEMENINO', '100M-FEM'];
                    
                    let foundSheet = null;
                    for (const name of possibleNames) {
                        foundSheet = sheetInfo.find(s => s.title.toUpperCase().includes(name.toUpperCase()));
                        if (foundSheet) {
                            console.log(`‚úÖ Encontrada: "${foundSheet.title}" con GID: ${foundSheet.gid}`);
                            break;
                        }
                    }
                    
                    if (!foundSheet) {
                        console.log('‚ùå No se encontr√≥ ninguna pesta√±a que coincida con 100M-FEMENINO');
                        console.log('üí° Pesta√±as disponibles:', sheetInfo.map(s => s.title));
                        return;
                    }
                    
                    // 3. Cargar datos espec√≠ficos de esa pesta√±a
                    console.log(`üìÑ Cargando datos de "${foundSheet.title}" (GID: ${foundSheet.gid})...`);
                    const data = await loadSheetByGid(foundSheet.gid);
                    
                    if (data && data.length > 0) {
                        console.log(`‚úÖ Datos cargados: ${data.length} filas`);
                        console.log('üìä TODOS LOS DATOS:');
                        data.forEach((row, index) => {
                            console.log(`  Fila ${index + 1}:`, row);
                        });
                        
                        // 4. Actualizar espec√≠ficamente la tabla 100m femenino
                        const table100mFem = document.getElementById('resultsTable100mFem');
                        if (table100mFem) {
                            console.log('üîÑ Actualizando tabla 100m femenino...');
                            updateTableContent(table100mFem, data, 'Nadadora');
                            console.log('‚úÖ Tabla actualizada');
                        }
                    } else {
                        console.log('‚ùå No se pudieron cargar datos de la pesta√±a');
                    }
                } else {
                    console.log('‚ùå No se pudo obtener informaci√≥n de las pesta√±as');
                }
                
            } catch (error) {
                console.error('‚ùå Error en test espec√≠fico:', error);
            }
        }

        // Funciones para tabs
        function openTab(evt, tabName) {
            var i, tabcontent, tabbuttons;
            
            tabcontent = document.getElementsByClassName("tab-content");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].classList.remove("active");
            }
            
            tabbuttons = document.getElementsByClassName("tab-button");
            for (i = 0; i < tabbuttons.length; i++) {
                tabbuttons[i].classList.remove("active");
            }
            
            document.getElementById(tabName).classList.add("active");
            evt.currentTarget.classList.add("active");
        }

        // Funci√≥n espec√≠fica para tabs de g√©nero (independiente de las pruebas)
        function openGenderTab(evt, tabName) {
            var i, genderTabContent, genderTabButtons;
            
            // Solo afectar las tabs de la secci√≥n de g√©nero
            const genderSection = evt.currentTarget.closest('.results-section');
            genderTabContent = genderSection.getElementsByClassName("tab-content");
            genderTabButtons = genderSection.getElementsByClassName("tab-button");
            
            for (i = 0; i < genderTabContent.length; i++) {
                genderTabContent[i].classList.remove("active");
            }
            
            for (i = 0; i < genderTabButtons.length; i++) {
                genderTabButtons[i].classList.remove("active");
            }
            
            document.getElementById(tabName).classList.add("active");
            evt.currentTarget.classList.add("active");
        }

        // Funci√≥n para recargar datos autom√°ticamente
        function startAutoReload() {
            console.log('üöÄ Iniciando sistema de recarga autom√°tica...');
            
            // Cargar datos inicialmente
            loadSheetData();
            
            // Recargar cada 3 minutos (optimizado para no saturar la API)
            setInterval(() => {
                console.log('üîÑ Recarga autom√°tica cada 3 minutos...');
                loadAttempts = 0; // Reset attempts counter
                loadSheetData();
            }, 180000);
            
            console.log('‚úÖ Sistema de recarga autom√°tica configurado (cada 3 minutos)');
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ P√°gina cargada, iniciando sistema de actualizaci√≥n autom√°tica...');
            console.log('üìã Google Sheet ID:', CONFIG.SHEET_ID);
            console.log('üîë API Key configurada:', CONFIG.API_KEY ? 'S√≠' : 'No');
            console.log('üåê URL del Sheet:', `https://docs.google.com/spreadsheets/d/${CONFIG.SHEET_ID}/edit`);
            console.log('‚ö° Verificando acceso al Google Sheet...');
            
            // Verificar acceso inmediato
            fetch(`https://docs.google.com/spreadsheets/d/${CONFIG.SHEET_ID}/export?format=csv&gid=0`)
                .then(response => {
                    console.log('üì° Respuesta del servidor:', response.status, response.statusText);
                    if (response.ok) {
                        console.log('‚úÖ Google Sheet es accesible');
                        console.log('üéØ Iniciando sistema de recarga autom√°tica...');
                        startAutoReload();
                    } else {
                        console.error('‚ùå Google Sheet no es accesible. Verifica que sea p√∫blico.');
                        console.log('‚ö†Ô∏è Intentando iniciar sistema de recarga de todas formas...');
                        startAutoReload();
                    }
                })
                .catch(error => {
                    console.error('‚ùå Error de conectividad:', error);
                    console.log('‚ö†Ô∏è Intentando iniciar sistema de recarga de todas formas...');
                    startAutoReload();
                });
        });

        // Recargar cuando la ventana vuelva al foco
        window.addEventListener('focus', function() {
            if (lastUpdateTime && (Date.now() - lastUpdateTime.getTime()) > 60000) {
                console.log('üëÅÔ∏è Ventana enfocada, recargando datos...');
                loadSheetData();
            }
        });

        // Recargar cuando se restaure la conexi√≥n a internet
        window.addEventListener('online', function() {
            console.log('üåê Conexi√≥n restaurada, recargando datos...');
            loadAttempts = 0;
            loadSheetData();
        });

        // Mostrar estado offline
        window.addEventListener('offline', function() {
            updateStatus('error', 'üì° Sin conexi√≥n a internet');
        });

        // Mobile Menu Toggle
        function toggleMobileMenu() {
            const mobileToggle = document.getElementById('mobileToggle');
            const navMenu = document.getElementById('navMenu');
            
            mobileToggle.classList.toggle('active');
            navMenu.classList.toggle('active');
        }

        // Smooth Scroll Function
        function scrollToSection(sectionClass) {
            const element = document.querySelector('.' + sectionClass);
            if (element) {
                element.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
            
            // Close mobile menu if open
            const mobileToggle = document.getElementById('mobileToggle');
            const navMenu = document.getElementById('navMenu');
            if (navMenu.classList.contains('active')) {
                mobileToggle.classList.remove('active');
                navMenu.classList.remove('active');
            }
        }

        // Add click event to mobile toggle
        document.addEventListener('DOMContentLoaded', function() {
            const mobileToggle = document.getElementById('mobileToggle');
            if (mobileToggle) {
                mobileToggle.addEventListener('click', toggleMobileMenu);
            }
            
            // Initialize search functionality
            initializeSearch();
        });

        // Search Functionality
        function initializeSearch() {
            // Search for Pruebas section
            const searchPruebas = document.getElementById('searchPruebas');
            if (searchPruebas) {
                searchPruebas.addEventListener('input', function() {
                    performSearch(this.value, 'pruebas');
                    toggleClearButton('searchPruebas');
                });
            }

            // Search for Gender section
            const searchGender = document.getElementById('searchGender');
            if (searchGender) {
                searchGender.addEventListener('input', function() {
                    performSearch(this.value, 'gender');
                    toggleClearButton('searchGender');
                });
            }
        }

        function toggleClearButton(inputId) {
            const input = document.getElementById(inputId);
            const clearBtn = input.nextElementSibling;
            if (input.value.length > 0) {
                clearBtn.style.display = 'block';
            } else {
                clearBtn.style.display = 'none';
            }
        }

        function clearSearch(inputId) {
            const input = document.getElementById(inputId);
            input.value = '';
            toggleClearButton(inputId);
            
            // Clear search based on section
            if (inputId === 'searchPruebas') {
                performSearch('', 'pruebas');
            } else if (inputId === 'searchGender') {
                performSearch('', 'gender');
            }
        }

        function performSearch(searchTerm, section) {
            const normalizedTerm = searchTerm.toLowerCase().trim();
            let foundResults = 0;
            let totalResults = 0;
            
            if (section === 'pruebas') {
                // Search in all pruebas tables
                const tables = ['resultsTableFem', 'resultsTableMas', 'resultsTable100mFem', 'resultsTable100mMas', 
                               'resultsTable200mFem', 'resultsTable200mMas', 'resultsTable4x50mFem', 'resultsTable4x50mMas'];
                
                tables.forEach(tableId => {
                    const table = document.getElementById(tableId);
                    if (table) {
                        const result = searchInTable(table, normalizedTerm);
                        foundResults += result.found;
                        totalResults += result.total;
                    }
                });
                
                updateSearchInfo('searchResultsPruebas', foundResults, totalResults, searchTerm);
                
            } else if (section === 'gender') {
                // Search in gender tables
                const tables = ['resultsTableMasculinoGeneral', 'resultsTableFemeninoGeneral'];
                
                tables.forEach(tableId => {
                    const table = document.getElementById(tableId);
                    if (table) {
                        const result = searchInTable(table, normalizedTerm);
                        foundResults += result.found;
                        totalResults += result.total;
                    }
                });
                
                updateSearchInfo('searchResultsGender', foundResults, totalResults, searchTerm);
            }
        }

        function searchInTable(table, searchTerm) {
            const rows = table.getElementsByTagName('tr');
            let foundResults = 0;
            let totalResults = 0;
            
            for (let i = 0; i < rows.length; i++) {
                const row = rows[i];
                
                // Skip header rows
                if (row.classList.contains('category-header') || i === 0) {
                    continue;
                }
                
                const cells = row.getElementsByTagName('td');
                if (cells.length === 0) continue;
                
                totalResults++;
                let rowContainsSearch = false;
                
                // Search in name column (usually first or second column)
                for (let j = 0; j < Math.min(cells.length, 3); j++) {
                    const cellText = cells[j].textContent.toLowerCase();
                    
                    // Remove previous highlights
                    cells[j].innerHTML = cells[j].textContent;
                    
                    if (searchTerm && cellText.includes(searchTerm)) {
                        rowContainsSearch = true;
                        // Highlight the search term
                        const originalText = cells[j].textContent;
                        const regex = new RegExp(`(${searchTerm})`, 'gi');
                        cells[j].innerHTML = originalText.replace(regex, '<span class="highlight-search">$1</span>');
                    }
                }
                
                // Show/hide row based on search
                if (searchTerm === '' || rowContainsSearch) {
                    row.style.display = '';
                    if (rowContainsSearch) foundResults++;
                } else {
                    row.style.display = 'none';
                }
            }
            
            return { found: foundResults, total: totalResults };
        }

        function updateSearchInfo(infoElementId, found, total, searchTerm) {
            const infoElement = document.getElementById(infoElementId);
            if (infoElement) {
                if (searchTerm === '') {
                    infoElement.textContent = '';
                } else if (found === 0) {
                    infoElement.textContent = `No se encontraron resultados para "${searchTerm}"`;
                } else {
                    infoElement.textContent = `Se encontraron ${found} resultado${found !== 1 ? 's' : ''} de ${total} total${total !== 1 ? 'es' : ''}`;
                }
            }
        }

        // Compartir funcionalidad
        function showShareOptions(swimmer, position, time, category) {
            // Limpiar datos para evitar problemas de formato
            swimmer = swimmer.replace(/['"]/g, '');
            category = category.replace(/['"]/g, '');
            time = time.replace(/['"]/g, '');
            
            // Determinar la prueba actual basado en el tab activo
            const activeTab = document.querySelector('.tab-button.active');
            let prueba = 'Nataci√≥n';
            if (activeTab) {
                const tabText = activeTab.textContent;
                if (tabText.includes('50m')) prueba = '50m Libre';
                else if (tabText.includes('100m')) prueba = '100m Libre';
                else if (tabText.includes('200m')) prueba = '200m Libre';
                else if (tabText.includes('4x50m')) prueba = '4x50m Libre';
                else if (tabText.includes('Masculino General')) prueba = 'Clasificaci√≥n General Masculina';
                else if (tabText.includes('Femenino General')) prueba = 'Clasificaci√≥n General Femenina';
                else if (tabText.includes('Equipos')) prueba = 'Clasificaci√≥n por Equipos';
            }
            
            const shareModal = document.createElement('div');
            shareModal.className = 'share-modal';
            shareModal.innerHTML = `
                <div class="share-modal-content">
                    <div class="share-modal-header">
                        <h3>üèä‚Äç‚ôÇÔ∏è Compartir Resultado</h3>
                        <button class="close-modal" onclick="closeShareModal()">&times;</button>
                    </div>
                    <div class="share-options">
                        <button class="share-option whatsapp" onclick="shareToWhatsApp('${swimmer}', '${position}', '${time}', '${prueba}')">
                            <span class="share-icon">üí¨</span>
                            WhatsApp
                        </button>
                        <button class="share-option instagram" onclick="shareToInstagram('${swimmer}', '${position}', '${time}', '${prueba}')">
                            <span class="share-icon">üì∑</span>
                            Instagram Stories
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(shareModal);
            
            // Cerrar modal al hacer clic fuera de √©l
            shareModal.addEventListener('click', function(e) {
                if (e.target === shareModal) {
                    closeShareModal();
                }
            });
        }

        function closeShareModal() {
            const modal = document.querySelector('.share-modal');
            if (modal) {
                modal.remove();
            }
        }

        function shareToWhatsApp(swimmer, position, time, prueba) {
            let message;
            if (time && time !== 'N/A' && time !== '-') {
                // Para nadadores individuales con tiempo
                message = `üèä‚Äç‚ôÇÔ∏è ${swimmer} termin√≥ en posici√≥n ${position} con tiempo ${time} en ${prueba} - IV Championship Master AquaTEN! üèÜ 

Ver m√°s resultados: https://ivchampionship.netlify.app`;
            } else {
                // Para equipos o clasificaci√≥n general
                if (prueba.includes('Equipos')) {
                    message = `üèä‚Äç‚ôÇÔ∏è El equipo ${swimmer} obtuvo el lugar ${position} en la ${prueba} - IV Championship Master AquaTEN! üèÜ 

Ver m√°s resultados: https://ivchampionship.netlify.app`;
                } else {
                    message = `üèä‚Äç‚ôÇÔ∏è ${swimmer} obtuvo la posici√≥n ${position} en ${prueba} - IV Championship Master AquaTEN! üèÜ 

Ver m√°s resultados: https://ivchampionship.netlify.app`;
                }
            }
            
            const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, '_blank');
            closeShareModal();
        }

        function shareToInstagram(swimmer, position, time, prueba) {
            let message;
            if (time && time !== 'N/A' && time !== '-') {
                // Para nadadores individuales con tiempo
                message = `üèä‚Äç‚ôÇÔ∏è ${swimmer} termin√≥ en posici√≥n ${position} con tiempo ${time} en ${prueba} - IV Championship Master AquaTEN! üèÜ 

#Nataci√≥nMaster #AquaTEN #Championship2024 #Swimming

Ver resultados completos: https://ivchampionship.netlify.app`;
            } else {
                // Para equipos o clasificaci√≥n general
                if (prueba.includes('Equipos')) {
                    message = `üèä‚Äç‚ôÇÔ∏è El equipo ${swimmer} obtuvo el lugar ${position} en la ${prueba} - IV Championship Master AquaTEN! üèÜ 

#Nataci√≥nMaster #AquaTEN #Championship2024 #Swimming #Equipos

Ver resultados completos: https://ivchampionship.netlify.app`;
                } else {
                    message = `üèä‚Äç‚ôÇÔ∏è ${swimmer} obtuvo la posici√≥n ${position} en ${prueba} - IV Championship Master AquaTEN! üèÜ 

#Nataci√≥nMaster #AquaTEN #Championship2024 #Swimming

Ver resultados completos: https://ivchampionship.netlify.app`;
                }
            }
            
            // Copiar al clipboard
            navigator.clipboard.writeText(message).then(function() {
                // Mostrar mensaje de confirmaci√≥n
                showClipboardMessage();
            }).catch(function(err) {
                console.error('Error al copiar al portapapeles: ', err);
                // Fallback para navegadores que no soportan clipboard API
                const textArea = document.createElement('textarea');
                textArea.value = message;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showClipboardMessage();
            });
            
            closeShareModal();
        }

        function showClipboardMessage() {
            const notification = document.createElement('div');
            notification.className = 'clipboard-notification';
            notification.innerHTML = `
                <div class="notification-content">
                    ‚úÖ Texto copiado al portapapeles
                    <br><small>Ahora puedes pegarlo en Instagram Stories</small>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.classList.add('show');
            }, 100);
            
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    notification.remove();
                }, 300);
            }, 3000);
        }

        // Funci√≥n para cargar jsPDF din√°micamente
        function loadjsPDF() {
            return new Promise((resolve, reject) => {
                if (window.jsPDF || (window.jspdf && window.jspdf.jsPDF)) {
                    resolve();
                    return;
                }
                
                const script = document.createElement('script');
                script.src = 'https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js';
                script.onload = () => {
                    // Esperar un poco para que jsPDF se inicialice completamente
                    setTimeout(() => {
                        if (window.jsPDF) {
                            resolve();
                        } else if (window.jspdf && window.jspdf.jsPDF) {
                            // Para la versi√≥n UMD moderna, asignar jsPDF al window global
                            window.jsPDF = window.jspdf.jsPDF;
                            resolve();
                        } else {
                            reject(new Error('jsPDF no se pudo cargar correctamente'));
                        }
                    }, 100);
                };
                script.onerror = () => reject(new Error('Error cargando jsPDF desde CDN'));
                document.head.appendChild(script);
            });
        }

        // Funci√≥n para descargar PDF con todos los resultados
        async function downloadResultsPDF() {
            const statusDiv = document.getElementById('pdfStatus');
            const downloadBtn = document.getElementById('downloadPdfBtn');
            
            statusDiv.style.display = 'block';
            statusDiv.innerHTML = '<p style="color: #0b1039; font-weight: 500;"><span style="font-size: 1.2em;">‚è≥</span> Cargando librer√≠a PDF...</p>';
            downloadBtn.disabled = true;
            downloadBtn.style.opacity = '0.6';
            
            try {
                // Cargar jsPDF si no est√° disponible
                await loadjsPDF();
                
                statusDiv.innerHTML = '<p style="color: #0b1039; font-weight: 500;"><span style="font-size: 1.2em;">‚è≥</span> Obteniendo datos frescos...</p>';
                
                // Verificar que jsPDF se carg√≥ correctamente
                if (!window.jsPDF) {
                    throw new Error('jsPDF no est√° disponible');
                }
                
                // Obtener datos frescos directamente del Google Sheet
                const allSheetData = await getAllSheetData();
                console.log('üìä Datos obtenidos para PDF:', Object.keys(allSheetData));
                
                statusDiv.innerHTML = '<p style="color: #0b1039; font-weight: 500;"><span style="font-size: 1.2em;">‚è≥</span> Generando PDF...</p>';
                
                const pdf = new window.jsPDF();
                let yPosition = 20;
                
                // Configurar fuentes y colores
                pdf.setFont("helvetica", "bold");
                pdf.setFontSize(18);
                pdf.setTextColor(11, 16, 57); // Color azul del sitio
                
                // T√≠tulo principal
                pdf.text("IV CHAMPIONSHIP MASTER AQUATEN - RESULTADOS OFICIALES", 105, yPosition, { align: "center" });
                yPosition += 15;
                
                pdf.setFontSize(12);
                pdf.setTextColor(102, 102, 102);
                pdf.text("Reporte generado el " + new Date().toLocaleDateString('es-ES') + " a las " + new Date().toLocaleTimeString('es-ES'), 105, yPosition, { align: "center" });
                yPosition += 20;
                
                // RESULTADOS POR PRUEBAS
                yPosition = await addEventResultsBoxesToPDF(pdf, yPosition, allSheetData);
                
                // Nueva p√°gina para resultados por g√©nero
                pdf.addPage();
                yPosition = 20;
                yPosition = await addGenderResultsBoxesToPDF(pdf, yPosition, allSheetData);
                
                // Nueva p√°gina para resultados por equipos
                pdf.addPage();
                yPosition = 20;
                await addTeamResultsBoxesToPDF(pdf, yPosition, allSheetData);
                
                // Guardar el PDF
                const fileName = `Resultados_IV_Championship_${new Date().toISOString().split('T')[0]}.pdf`;
                pdf.save(fileName);
                
                // Ocultar status
                statusDiv.style.display = 'none';
                
            } catch (error) {
                console.error('Error generando PDF:', error);
                let errorMessage = 'Error desconocido';
                if (error.message.includes('jsPDF')) {
                    errorMessage = 'Error cargando la librer√≠a PDF. Verifica tu conexi√≥n a internet.';
                } else if (error.message.includes('network')) {
                    errorMessage = 'Error de conexi√≥n. Verifica tu internet.';
                } else {
                    errorMessage = error.message || 'Error procesando los datos para el PDF';
                }
                
                statusDiv.innerHTML = `<p style="color: red;">‚ùå ${errorMessage}<br><small>Revisa la consola para m√°s detalles.</small></p>`;
                setTimeout(() => {
                    statusDiv.style.display = 'none';
                }, 5000);
            } finally {
                downloadBtn.disabled = false;
                downloadBtn.style.opacity = '1';
            }
        }

        // Funci√≥n para cargar datos directamente del Google Sheet
        async function loadDirectSheetData(gid, sheetName) {
            try {
                const url = `https://docs.google.com/spreadsheets/d/${CONFIG.SHEET_ID}/export?format=csv&gid=${gid}`;
                const response = await fetch(url);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }
                
                const csvText = await response.text();
                const rows = csvText.split('\n').map(row => {
                    // Parse CSV properly handling commas in quotes
                    const result = [];
                    let current = '';
                    let inQuotes = false;
                    
                    for (let i = 0; i < row.length; i++) {
                        const char = row[i];
                        if (char === '"') {
                            inQuotes = !inQuotes;
                        } else if (char === ',' && !inQuotes) {
                            result.push(current.trim());
                            current = '';
                        } else {
                            current += char;
                        }
                    }
                    result.push(current.trim());
                    return result;
                }).filter(row => row.length > 1 && row[0]); // Filter empty rows
                
                return rows.slice(1); // Skip header row
            } catch (error) {
                console.error(`Error cargando ${sheetName}:`, error);
                return [];
            }
        }

        // Funci√≥n para cargar todas las hojas por posici√≥n
        async function getAllSheetData() {
            try {
                console.log('üîç Cargando hojas del Google Sheet por posici√≥n...');
                
                // Primero obtener informaci√≥n de todas las hojas disponibles
                const sheetInfo = await getSheetInfo();
                
                // Validar que se obtuvieron los datos del sheet
                if (!sheetInfo || !Array.isArray(sheetInfo)) {
                    console.error('‚ùå No se pudo obtener informaci√≥n de las hojas');
                    console.error('üìÑ SheetInfo recibido:', sheetInfo);
                    throw new Error('No se pudo acceder a la informaci√≥n de las hojas del Google Sheet');
                }
                
                console.log('üìã Total de hojas disponibles:', sheetInfo.length);
                console.log('üìã Hojas:', sheetInfo.map((s, i) => `${i}: ${s.title} (GID: ${s.gid})`));
                
                const allData = {
                    eventos: [],
                    masculino: [],
                    femenino: [],
                    equipos: []
                };
                
                // Cargar primeras 8 hojas (eventos)
                console.log('üèä‚Äç‚ôÄÔ∏è Cargando hojas de eventos (0-7)...');
                for (let i = 0; i < Math.min(8, sheetInfo.length); i++) {
                    const sheet = sheetInfo[i];
                    console.log(`üìÑ Cargando evento ${i + 1}: ${sheet.title}`);
                    
                    try {
                        const data = await loadSheetByGid(sheet.gid);
                        if (data && data.length > 0) {
                            console.log(`‚úÖ ${sheet.title}: ${data.length} filas`);
                            allData.eventos.push({
                                name: sheet.title,
                                data: data
                            });
                        }
                    } catch (error) {
                        console.warn(`‚ö†Ô∏è Error cargando ${sheet.title}:`, error);
                    }
                }
                
                // Cargar siguiente 2 hojas (g√©nero) - posiciones 8 y 9
                console.log('üë• Cargando hojas de g√©nero (8-9)...');
                if (sheetInfo.length > 8) {
                    const maleSheet = sheetInfo[8];
                    console.log(`üìÑ Cargando masculino: ${maleSheet.title}`);
                    try {
                        const maleData = await loadSheetByGid(maleSheet.gid);
                        if (maleData && maleData.length > 0) {
                            console.log(`‚úÖ Masculino: ${maleData.length} filas`);
                            allData.masculino = maleData;
                        }
                    } catch (error) {
                        console.warn(`‚ö†Ô∏è Error cargando masculino:`, error);
                    }
                }
                
                if (sheetInfo.length > 9) {
                    const femaleSheet = sheetInfo[9];
                    console.log(`üìÑ Cargando femenino: ${femaleSheet.title}`);
                    try {
                        const femaleData = await loadSheetByGid(femaleSheet.gid);
                        if (femaleData && femaleData.length > 0) {
                            console.log(`‚úÖ Femenino: ${femaleData.length} filas`);
                            allData.femenino = femaleData;
                        }
                    } catch (error) {
                        console.warn(`‚ö†Ô∏è Error cargando femenino:`, error);
                    }
                }
                
                // Cargar √∫ltima hoja (equipos)
                console.log('üèÜ Cargando hoja de equipos (√∫ltima)...');
                if (sheetInfo.length > 10) {
                    const teamSheet = sheetInfo[sheetInfo.length - 1];
                    console.log(`üìÑ Cargando equipos: ${teamSheet.title}`);
                    try {
                        const teamData = await loadSheetByGid(teamSheet.gid);
                        if (teamData && teamData.length > 0) {
                            console.log(`‚úÖ Equipos: ${teamData.length} filas`);
                            allData.equipos = teamData;
                        }
                    } catch (error) {
                        console.warn(`‚ö†Ô∏è Error cargando equipos:`, error);
                    }
                }
                
                console.log('üìä Resumen final:', {
                    eventos: allData.eventos.length,
                    masculino: allData.masculino.length,
                    femenino: allData.femenino.length,
                    equipos: allData.equipos.length
                });
                
                return allData;
                
            } catch (error) {
                console.error('‚ùå Error cargando datos del Google Sheet:', error);
                
                // Como fallback, intentar cargar la primera hoja disponible
                console.log('üîÑ Intentando fallback con la primera hoja...');
                try {
                    const fallbackData = await loadSheetByGid(0);
                    if (fallbackData && fallbackData.length > 0) {
                        console.log('‚úÖ Fallback exitoso:', fallbackData.length, 'filas');
                        // Organizar todos los datos en eventos como √∫ltimo recurso
                        return {
                            eventos: [{ name: 'Resultados Generales', data: fallbackData }],
                            masculino: [],
                            femenino: [],
                            equipos: []
                        };
                    }
                } catch (fallbackError) {
                    console.error('‚ùå Fallback tambi√©n fall√≥:', fallbackError);
                }
                
                // Si todo falla, devolver estructura vac√≠a
                return {
                    eventos: [],
                    masculino: [],
                    femenino: [],
                    equipos: []
                };
            }
        }

        // Funci√≥n de respaldo para leer desde las tablas HTML
        function getDataFromHTMLTables() {
            const allData = {};
            
            // Mapear todas las posibles variantes de nombres de hojas
            const eventTables = [
                { id: 'resultsTableFem', names: ['50M-FEMENINO', 'FEMENINO', '50M FEM'] },
                { id: 'resultsTableMas', names: ['50M-MASCULINO', 'MASCULINO', '50M MAS'] },
                { id: 'resultsTable100mFem', names: ['100M-FEMENINO', '100M FEM'] },
                { id: 'resultsTable100mMas', names: ['100M-MASCULINO', '100M MAS'] },
                { id: 'resultsTable200mFem', names: ['200M-FEMENINO', '200M FEM'] },
                { id: 'resultsTable200mMas', names: ['200M-MASCULINO', '200M MAS'] },
                { id: 'resultsTable4x50mFem', names: ['4X50M-FEMENINO', '4X50M FEM'] },
                { id: 'resultsTable4x50mMas', names: ['4X50M-MASCULINO', '4X50M MAS'] }
            ];
            
            eventTables.forEach(({ id, names }) => {
                const table = document.getElementById(id);
                if (table) {
                    const data = [];
                    const rows = table.querySelectorAll('tbody tr:not(.loading-row)');
                    rows.forEach(row => {
                        const cells = row.querySelectorAll('td');
                        if (cells.length >= 4) {
                            data.push({
                                position: cells[0].textContent.trim(),
                                athlete: cells[1].textContent.trim(),
                                team: cells[2].textContent.trim(),
                                time: cells[3].textContent.trim(),
                                points: cells[4] ? cells[4].textContent.trim() : ''
                            });
                        }
                    });
                    if (data.length > 0) {
                        // Usar todos los nombres posibles para esta tabla
                        names.forEach(name => {
                            allData[name] = data;
                        });
                    }
                }
            });
            
            // Agregar datos por g√©nero con m√∫ltiples nombres
            const genderTables = [
                { id: 'resultsTableMasculinoGeneral', names: ['RESULTADOS-MASCULINO', 'RESULTADOS MASCULINO', 'MASCULINO'] },
                { id: 'resultsTableFemeninoGeneral', names: ['RESULTADOS-FEMENINO', 'RESULTADOS FEMENINO', 'FEMENINO'] }
            ];
            
            genderTables.forEach(({ id, names }) => {
                const table = document.getElementById(id);
                if (table) {
                    const data = [];
                    const rows = table.querySelectorAll('tbody tr:not(.loading-row)');
                    rows.forEach(row => {
                        const cells = row.querySelectorAll('td');
                        if (cells.length >= 4) {
                            data.push({
                                position: cells[0].textContent.trim(),
                                athlete: cells[1].textContent.trim(),
                                team: cells[2].textContent.trim(),
                                points: cells[3].textContent.trim()
                            });
                        }
                    });
                    if (data.length > 0) {
                        // Usar todos los nombres posibles
                        names.forEach(name => {
                            allData[name] = data;
                        });
                    }
                }
            });
            
            // Agregar datos por equipo con m√∫ltiples nombres
            const teamsTable = document.getElementById('resultsTableTeams');
            if (teamsTable) {
                const data = [];
                const rows = teamsTable.querySelectorAll('tbody tr:not(.loading-row)');
                rows.forEach(row => {
                    const cells = row.querySelectorAll('td');
                    if (cells.length >= 3) {
                        data.push({
                            position: cells[0].textContent.trim(),
                            team: cells[1].textContent.trim(),
                            points: cells[2].textContent.trim()
                        });
                    }
                });
                if (data.length > 0) {
                    // Usar todos los nombres posibles para equipos
                    const teamNames = ['EQUIPOS', 'EQUIPO', 'TEAMS', 'CLASIFICACION EQUIPOS'];
                    teamNames.forEach(name => {
                        allData[name] = data;
                    });
                }
            }
            
            return allData;
        }

        // Funci√≥n para formatear tiempo correctamente
        function formatTime(timeStr) {
            if (!timeStr || timeStr === '') return '';
            
            // Si ya est√° en formato mm:ss,cc, devolverlo tal como est√°
            if (/^\d{1,2}:\d{2},\d{2}$/.test(timeStr)) {
                return timeStr;
            }
            
            // Si est√° en formato mm:ss.cc, convertir a mm:ss,cc
            if (/^\d{1,2}:\d{2}\.\d{2}$/.test(timeStr)) {
                return timeStr.replace('.', ',');
            }
            
            // Si est√° en formato de segundos decimales (ej: 30.45), convertir a mm:ss,cc
            if (/^\d+\.\d{2}$/.test(timeStr)) {
                const totalSeconds = parseFloat(timeStr);
                const minutes = Math.floor(totalSeconds / 60);
                const seconds = Math.floor(totalSeconds % 60);
                const centiseconds = Math.round((totalSeconds % 1) * 100);
                return `${minutes}:${seconds.toString().padStart(2, '0')},${centiseconds.toString().padStart(2, '0')}`;
            }
            
            return timeStr; // Devolver sin cambios si no coincide con ning√∫n formato
        }

        // Funci√≥n para separar datos por tipo desde RESULTADOS
        function parseResultadosData(allRows) {
            const sections = {
                eventos: [],
                masculino: [],
                femenino: [],
                equipos: []
            };
            
            let currentSection = null;
            
            for (let i = 0; i < allRows.length; i++) {
                const row = allRows[i];
                const firstCell = (row[0] || '').toString().toLowerCase().trim();
                
                // Detectar secciones por palabras clave
                if (firstCell.includes('50m') || firstCell.includes('100m') || firstCell.includes('200m') || firstCell.includes('4x50m')) {
                    currentSection = 'eventos';
                    continue;
                } else if (firstCell.includes('masculino') && firstCell.includes('general')) {
                    currentSection = 'masculino';
                    continue;
                } else if (firstCell.includes('femenino') && firstCell.includes('general')) {
                    currentSection = 'femenino';
                    continue;
                } else if (firstCell.includes('equipo') || firstCell.includes('clasificacion')) {
                    currentSection = 'equipos';
                    continue;
                }
                
                // Agregar datos a la secci√≥n actual
                if (currentSection && row.length >= 3 && 
                    !firstCell.includes('lugar') && !firstCell.includes('pos') &&
                    row[0] && row[1]) {
                    sections[currentSection].push(row);
                }
            }
            
            console.log('üìä Secciones parseadas:', {
                eventos: sections.eventos.length,
                masculino: sections.masculino.length,
                femenino: sections.femenino.length,
                equipos: sections.equipos.length
            });
            
            return sections;
        }

        // Nueva funci√≥n para agregar resultados por prueba con formato profesional
        async function addEventResultsBoxesToPDF(pdf, startY, allSheetData) {
            let yPosition = startY;
            
            // T√≠tulo de secci√≥n
            pdf.setFont("helvetica", "bold");
            pdf.setFontSize(16);
            pdf.setTextColor(11, 16, 57);
            pdf.text("RESULTADOS POR PRUEBAS", 20, yPosition);
            yPosition += 20;
            
            const eventos = allSheetData.eventos || [];
            
            if (eventos.length > 0) {
                for (const evento of eventos) {
                    // Verificar espacio en la p√°gina
                    if (yPosition > 200) {
                        pdf.addPage();
                        yPosition = 30;
                    }
                    
                    // T√≠tulo del evento
                    pdf.setFont("helvetica", "bold");
                    pdf.setFontSize(12);
                    pdf.setTextColor(11, 16, 57);
                    pdf.text(evento.name, 20, yPosition);
                    yPosition += 12;
                    
                    // Crear tabla profesional
                    const tableData = evento.data.map((row, index) => {
                        // Mapear columnas del CSV (pos, athlete, team, tiempo/edad, categoria, puntos)
                        const [pos, athlete, team, timeOrAge, category, points] = row;
                        return {
                            position: pos || (index + 1).toString(),
                            athlete: athlete || '',
                            team: team || '',
                            time: formatTime(timeOrAge) || '',
                            points: points || ''
                        };
                    });
                    
                    yPosition = drawProfessionalTable(pdf, tableData, yPosition, 'event');
                    yPosition += 10;
                }
            } else {
                pdf.setFont("helvetica", "normal");
                pdf.setFontSize(10);
                pdf.setTextColor(128, 128, 128);
                pdf.text("No se encontraron datos de eventos", 20, yPosition);
                yPosition += 20;
            }
            
            return yPosition;
        }

        // Funci√≥n para dibujar tabla profesional
        function drawProfessionalTable(pdf, data, startY, type) {
            let yPosition = startY;
            const boxX = 20;
            const boxWidth = 170;
            const headerHeight = 10;
            const rowHeight = 8;
            const maxRows = Math.min(data.length, 20); // Mostrar m√°ximo 20 resultados
            const boxHeight = headerHeight + (maxRows * rowHeight);
            
            // Marco principal
            pdf.setDrawColor(11, 16, 57);
            pdf.setLineWidth(1);
            pdf.rect(boxX, yPosition, boxWidth, boxHeight);
            
            // Header con fondo azul
            pdf.setFillColor(11, 16, 57);
            pdf.rect(boxX, yPosition, boxWidth, headerHeight, 'F');
            
            // Configurar headers seg√∫n el tipo
            pdf.setFont("helvetica", "bold");
            pdf.setFontSize(9);
            pdf.setTextColor(255, 255, 255);
            
            if (type === 'event') {
                pdf.text("POS", boxX + 3, yPosition + 7);
                pdf.text("ATLETA", boxX + 18, yPosition + 7);
                pdf.text("EQUIPO", boxX + 80, yPosition + 7);
                pdf.text("TIEMPO", boxX + 120, yPosition + 7);
                pdf.text("PUNTOS", boxX + 150, yPosition + 7);
            } else if (type === 'gender') {
                pdf.text("POS", boxX + 3, yPosition + 7);
                pdf.text("ATLETA", boxX + 18, yPosition + 7);
                pdf.text("EQUIPO", boxX + 100, yPosition + 7);
                pdf.text("PUNTOS", boxX + 145, yPosition + 7);
            } else if (type === 'team') {
                pdf.text("POS", boxX + 3, yPosition + 7);
                pdf.text("EQUIPO", boxX + 25, yPosition + 7);
                pdf.text("PUNTOS TOTALES", boxX + 120, yPosition + 7);
            }
            
            yPosition += headerHeight;
            
            // Datos
            pdf.setFont("helvetica", "normal");
            pdf.setFontSize(8);
            pdf.setTextColor(0, 0, 0);
            
            data.slice(0, maxRows).forEach((row, index) => {
                const rowY = yPosition + (index * rowHeight);
                
                // Fondo alternado
                if (index % 2 === 0) {
                    pdf.setFillColor(248, 249, 250);
                    pdf.rect(boxX, rowY, boxWidth, rowHeight, 'F');
                }
                
                // Destacar podio para equipos
                if (type === 'team' && index < 3) {
                    const colors = [
                        [255, 215, 0],   // Oro
                        [192, 192, 192], // Plata
                        [205, 127, 50]   // Bronce
                    ];
                    pdf.setFillColor(...colors[index]);
                    pdf.rect(boxX, rowY, boxWidth, rowHeight, 'F');
                }
                
                // L√≠neas separadoras verticales
                pdf.setDrawColor(200, 200, 200);
                pdf.setLineWidth(0.3);
                
                if (type === 'event') {
                    pdf.line(boxX + 15, yPosition, boxX + 15, yPosition + (maxRows * rowHeight));
                    pdf.line(boxX + 75, yPosition, boxX + 75, yPosition + (maxRows * rowHeight));
                    pdf.line(boxX + 115, yPosition, boxX + 115, yPosition + (maxRows * rowHeight));
                    pdf.line(boxX + 145, yPosition, boxX + 145, yPosition + (maxRows * rowHeight));
                    
                    // Texto para eventos
                    pdf.text(row.position, boxX + 5, rowY + 5.5);
                    pdf.text((row.athlete || '').substring(0, 22), boxX + 18, rowY + 5.5);
                    pdf.text((row.team || '').substring(0, 12), boxX + 77, rowY + 5.5);
                    pdf.text(row.time || '', boxX + 117, rowY + 5.5);
                    pdf.text(row.points || '', boxX + 147, rowY + 5.5);
                    
                } else if (type === 'gender') {
                    pdf.line(boxX + 15, yPosition, boxX + 15, yPosition + (maxRows * rowHeight));
                    pdf.line(boxX + 95, yPosition, boxX + 95, yPosition + (maxRows * rowHeight));
                    pdf.line(boxX + 140, yPosition, boxX + 140, yPosition + (maxRows * rowHeight));
                    
                    // Texto para g√©nero
                    pdf.text(row.position, boxX + 5, rowY + 5.5);
                    pdf.text((row.athlete || '').substring(0, 25), boxX + 18, rowY + 5.5);
                    pdf.text((row.team || '').substring(0, 15), boxX + 97, rowY + 5.5);
                    pdf.text(row.points || '', boxX + 142, rowY + 5.5);
                    
                } else if (type === 'team') {
                    pdf.line(boxX + 20, yPosition, boxX + 20, yPosition + (maxRows * rowHeight));
                    pdf.line(boxX + 115, yPosition, boxX + 115, yPosition + (maxRows * rowHeight));
                    
                    // Texto para equipos
                    pdf.text(row.position, boxX + 5, rowY + 5.5);
                    pdf.text((row.team || '').substring(0, 30), boxX + 25, rowY + 5.5);
                    pdf.text(row.points || '', boxX + 125, rowY + 5.5);
                }
            });
            
            return yPosition + (maxRows * rowHeight) + 5;
        }

        // Nueva funci√≥n para agregar resultados por g√©nero con formato profesional
        async function addGenderResultsBoxesToPDF(pdf, startY, allSheetData) {
            let yPosition = startY;
            
            // T√≠tulo de secci√≥n
            pdf.setFont("helvetica", "bold");
            pdf.setFontSize(16);
            pdf.setTextColor(11, 16, 57);
            pdf.text("RESULTADOS POR G√âNERO", 20, yPosition);
            yPosition += 20;
            
            // Resultados Masculinos
            if (allSheetData.masculino.length > 0) {
                pdf.setFont("helvetica", "bold");
                pdf.setFontSize(12);
                pdf.setTextColor(11, 16, 57);
                pdf.text("CLASIFICACI√ìN GENERAL MASCULINA", 20, yPosition);
                yPosition += 12;
                
                const tableData = allSheetData.masculino.map((row, index) => {
                    const [pos, athlete, team, age, category, points] = row;
                    return {
                        position: pos || (index + 1).toString(),
                        athlete: athlete || '',
                        team: team || '',
                        points: points || ''
                    };
                });
                
                yPosition = drawProfessionalTable(pdf, tableData, yPosition, 'gender');
                yPosition += 15;
            }
            
            // Nueva p√°gina para femeninos si es necesario
            if (yPosition > 150) {
                pdf.addPage();
                yPosition = 30;
            }
            
            // Resultados Femeninos
            if (allSheetData.femenino.length > 0) {
                pdf.setFont("helvetica", "bold");
                pdf.setFontSize(12);
                pdf.setTextColor(11, 16, 57);
                pdf.text("CLASIFICACI√ìN GENERAL FEMENINA", 20, yPosition);
                yPosition += 12;
                
                const tableData = allSheetData.femenino.map((row, index) => {
                    const [pos, athlete, team, age, category, points] = row;
                    return {
                        position: pos || (index + 1).toString(),
                        athlete: athlete || '',
                        team: team || '',
                        points: points || ''
                    };
                });
                
                yPosition = drawProfessionalTable(pdf, tableData, yPosition, 'gender');
            }
            
            return yPosition;
        }

        // Nueva funci√≥n para agregar resultados por equipos con formato profesional
        async function addTeamResultsBoxesToPDF(pdf, startY, allSheetData) {
            let yPosition = startY;
            
            // T√≠tulo de secci√≥n
            pdf.setFont("helvetica", "bold");
            pdf.setFontSize(16);
            pdf.setTextColor(11, 16, 57);
            pdf.text("CLASIFICACI√ìN GENERAL POR EQUIPOS", 20, yPosition);
            yPosition += 20;
            
            if (allSheetData.equipos.length > 0) {
                // Crear tabla con todos los equipos
                const tableData = allSheetData.equipos.map((row, index) => {
                    const [pos, team, points] = row;
                    return {
                        position: pos || (index + 1).toString(),
                        team: team || '',
                        points: points || ''
                    };
                });
                
                yPosition = drawProfessionalTable(pdf, tableData, yPosition, 'team');
            } else {
                pdf.setFont("helvetica", "normal");
                pdf.setFontSize(10);
                pdf.setTextColor(128, 128, 128);
                pdf.text("No se encontraron datos de equipos", 20, yPosition);
                yPosition += 20;
            }
            
            return yPosition;
        }
        
        async function addEventResultsToPDF(pdf, startY) {
            let yPosition = startY;
            
            try {
                // T√≠tulo de secci√≥n
                pdf.setFont("helvetica", "bold");
                pdf.setFontSize(14);
                pdf.setTextColor(11, 16, 57);
                pdf.text("RESULTADOS POR PRUEBAS", 20, yPosition);
                yPosition += 15;
                
                // Obtener datos de cada prueba con sus IDs correctos
                const eventTables = [
                    { id: 'resultsTableFem', name: '50m Libre Femenino' },
                    { id: 'resultsTableMas', name: '50m Libre Masculino' },
                    { id: 'resultsTable100mFem', name: '100m Libre Femenino' },
                    { id: 'resultsTable100mMas', name: '100m Libre Masculino' },
                    { id: 'resultsTable200mFem', name: '200m Libre Femenino' },
                    { id: 'resultsTable200mMas', name: '200m Libre Masculino' },
                    { id: 'resultsTable4x50mFem', name: '4x50m Libre Femenino' },
                    { id: 'resultsTable4x50mMas', name: '4x50m Libre Masculino' }
                ];
                
                for (let i = 0; i < eventTables.length; i++) {
                    const { id: tableId, name: eventName } = eventTables[i];
                    const table = document.getElementById(tableId);
                
                if (table) {
                    // Nueva p√°gina si no es el primer evento y no hay espacio
                    if (i > 0 && yPosition > 200) {
                        pdf.addPage();
                        yPosition = 20;
                    }
                    
                    pdf.setFont("helvetica", "bold");
                    pdf.setFontSize(12);
                    pdf.text(eventName, 20, yPosition);
                    yPosition += 10;
                    
                    // Obtener TODOS los resultados
                    const rows = table.querySelectorAll('tbody tr:not(.loading-row)');
                    const allResults = Array.from(rows);
                    
                    pdf.setFont("helvetica", "normal");
                    pdf.setFontSize(8);
                    
                    allResults.forEach((row, index) => {
                        const cells = row.querySelectorAll('td');
                        if (cells.length > 3) {
                            // Verificar si necesitamos nueva p√°gina
                            if (yPosition > 270) {
                                pdf.addPage();
                                yPosition = 20;
                                
                                // Repetir t√≠tulo del evento en nueva p√°gina
                                pdf.setFont("helvetica", "bold");
                                pdf.setFontSize(12);
                                pdf.text(`${eventNames[i]} (continuaci√≥n)`, 20, yPosition);
                                yPosition += 10;
                                pdf.setFont("helvetica", "normal");
                                pdf.setFontSize(8);
                            }
                            
                            const pos = cells[0]?.textContent?.trim() || (index + 1);
                            const name = cells[1]?.textContent?.trim() || 'N/A';
                            const team = cells[2]?.textContent?.trim() || 'N/A';
                            const age = cells[3]?.textContent?.trim() || 'N/A';
                            const category = cells[4]?.textContent?.trim() || 'N/A';
                            const time = cells[5]?.textContent?.trim() || 'N/A';
                            const points = cells[6]?.textContent?.trim() || 'N/A';
                            
                            pdf.text(`${pos}. ${name} (${team}) - ${age} a√±os - ${category} - ${time} - ${points} pts`, 25, yPosition);
                            yPosition += 4;
                        }
                    });
                    
                    yPosition += 10; // Espacio entre eventos
                }
            }
            } catch (error) {
                console.error('Error en addEventResultsToPDF:', error);
                pdf.setFont("helvetica", "normal");
                pdf.setFontSize(10);
                pdf.text("Error cargando resultados por pruebas", 20, yPosition);
                throw error;
            }
        }
        
        async function addGenderResultsToPDF(pdf, startY) {
            let yPosition = startY;
            
            // T√≠tulo de secci√≥n
            pdf.setFont("helvetica", "bold");
            pdf.setFontSize(14);
            pdf.setTextColor(11, 16, 57);
            pdf.text("RESULTADOS POR G√âNERO", 20, yPosition);
            yPosition += 15;
            
            // Resultados Masculinos
            const maleTable = document.getElementById('resultsTableMasculinoGeneral');
            if (maleTable) {
                pdf.setFont("helvetica", "bold");
                pdf.setFontSize(12);
                pdf.text("CLASIFICACI√ìN GENERAL MASCULINA", 20, yPosition);
                yPosition += 10;
                
                const maleRows = maleTable.querySelectorAll('tbody tr:not(.loading-row)');
                const allMaleResults = Array.from(maleRows); // TODOS los resultados masculinos
                
                pdf.setFont("helvetica", "normal");
                pdf.setFontSize(8);
                
                allMaleResults.forEach((row, index) => {
                    const cells = row.querySelectorAll('td');
                    if (cells.length > 5) {
                        // Verificar si necesitamos nueva p√°gina
                        if (yPosition > 270) {
                            pdf.addPage();
                            yPosition = 20;
                            
                            // Repetir t√≠tulo en nueva p√°gina
                            pdf.setFont("helvetica", "bold");
                            pdf.setFontSize(12);
                            pdf.text("CLASIFICACI√ìN GENERAL MASCULINA (continuaci√≥n)", 20, yPosition);
                            yPosition += 10;
                            pdf.setFont("helvetica", "normal");
                            pdf.setFontSize(8);
                        }
                        
                        const pos = cells[0]?.textContent?.trim() || (index + 1);
                        const name = cells[1]?.textContent?.trim() || 'N/A';
                        const team = cells[2]?.textContent?.trim() || 'N/A';
                        const age = cells[3]?.textContent?.trim() || 'N/A';
                        const category = cells[4]?.textContent?.trim() || 'N/A';
                        const totalPoints = cells[5]?.textContent?.trim() || '0';
                        const points200 = cells[6]?.textContent?.trim() || '0';
                        const points50 = cells[7]?.textContent?.trim() || '0';
                        const points100 = cells[8]?.textContent?.trim() || '0';
                        
                        pdf.text(`${pos}. ${name} (${team}) - ${age} a√±os - ${category}`, 25, yPosition);
                        yPosition += 4;
                        pdf.text(`   Total: ${totalPoints} pts (200m: ${points200}, 50m: ${points50}, 100m: ${points100})`, 25, yPosition);
                        yPosition += 6;
                    }
                });
            }
            
            yPosition += 15;
            
            // Verificar espacio para secci√≥n femenina
            if (yPosition > 200) {
                pdf.addPage();
                yPosition = 20;
            }
            
            // Resultados Femeninos
            const femaleTable = document.getElementById('resultsTableFemeninoGeneral');
            if (femaleTable) {
                pdf.setFont("helvetica", "bold");
                pdf.setFontSize(12);
                pdf.text("CLASIFICACI√ìN GENERAL FEMENINA", 20, yPosition);
                yPosition += 10;
                
                const femaleRows = femaleTable.querySelectorAll('tbody tr:not(.loading-row)');
                const allFemaleResults = Array.from(femaleRows); // TODOS los resultados femeninos
                
                pdf.setFont("helvetica", "normal");
                pdf.setFontSize(8);
                
                allFemaleResults.forEach((row, index) => {
                    const cells = row.querySelectorAll('td');
                    if (cells.length > 5) {
                        // Verificar si necesitamos nueva p√°gina
                        if (yPosition > 270) {
                            pdf.addPage();
                            yPosition = 20;
                            
                            // Repetir t√≠tulo en nueva p√°gina
                            pdf.setFont("helvetica", "bold");
                            pdf.setFontSize(12);
                            pdf.text("CLASIFICACI√ìN GENERAL FEMENINA (continuaci√≥n)", 20, yPosition);
                            yPosition += 10;
                            pdf.setFont("helvetica", "normal");
                            pdf.setFontSize(8);
                        }
                        
                        const pos = cells[0]?.textContent?.trim() || (index + 1);
                        const name = cells[1]?.textContent?.trim() || 'N/A';
                        const team = cells[2]?.textContent?.trim() || 'N/A';
                        const age = cells[3]?.textContent?.trim() || 'N/A';
                        const category = cells[4]?.textContent?.trim() || 'N/A';
                        const totalPoints = cells[5]?.textContent?.trim() || '0';
                        const points200 = cells[6]?.textContent?.trim() || '0';
                        const points50 = cells[7]?.textContent?.trim() || '0';
                        const points100 = cells[8]?.textContent?.trim() || '0';
                        
                        pdf.text(`${pos}. ${name} (${team}) - ${age} a√±os - ${category}`, 25, yPosition);
                        yPosition += 4;
                        pdf.text(`   Total: ${totalPoints} pts (200m: ${points200}, 50m: ${points50}, 100m: ${points100})`, 25, yPosition);
                        yPosition += 6;
                    }
                });
            }
        }
        
        async function addTeamResultsToPDF(pdf, startY) {
            let yPosition = startY;
            
            // T√≠tulo de secci√≥n
            pdf.setFont("helvetica", "bold");
            pdf.setFontSize(14);
            pdf.setTextColor(11, 16, 57);
            pdf.text("CLASIFICACI√ìN GENERAL POR EQUIPOS", 20, yPosition);
            yPosition += 15;
            
            const teamsTable = document.getElementById('resultsTableTeams');
            if (teamsTable) {
                const teamRows = teamsTable.querySelectorAll('tbody tr:not(.loading-row)');
                const allTeamResults = Array.from(teamRows); // TODOS los equipos
                
                pdf.setFont("helvetica", "normal");
                pdf.setFontSize(9);
                
                allTeamResults.forEach((row, index) => {
                    const cells = row.querySelectorAll('td');
                    if (cells.length > 2) {
                        // Verificar si necesitamos nueva p√°gina
                        if (yPosition > 250) {
                            pdf.addPage();
                            yPosition = 20;
                            
                            // Repetir t√≠tulo en nueva p√°gina
                            pdf.setFont("helvetica", "bold");
                            pdf.setFontSize(14);
                            pdf.setTextColor(11, 16, 57);
                            pdf.text("CLASIFICACI√ìN GENERAL POR EQUIPOS (continuaci√≥n)", 20, yPosition);
                            yPosition += 15;
                            pdf.setFont("helvetica", "normal");
                            pdf.setFontSize(9);
                        }
                        
                        const pos = cells[0]?.textContent?.trim() || (index + 1);
                        const team = cells[1]?.textContent?.trim() || 'N/A';
                        const totalPoints = cells[2]?.textContent?.trim() || '0';
                        const femalePoints = cells[3]?.textContent?.trim() || '0';
                        const malePoints = cells[4]?.textContent?.trim() || '0';
                        
                        pdf.setFont("helvetica", "bold");
                        pdf.text(`${pos}. ${team}`, 25, yPosition);
                        yPosition += 5;
                        
                        pdf.setFont("helvetica", "normal");
                        pdf.text(`   Puntos Totales: ${totalPoints}`, 25, yPosition);
                        yPosition += 4;
                        pdf.text(`   Puntos Femeninos: ${femalePoints}`, 25, yPosition);
                        yPosition += 4;
                        pdf.text(`   Puntos Masculinos: ${malePoints}`, 25, yPosition);
                        yPosition += 8; // Espacio entre equipos
                    }
                });
            }
            
            // Pie de p√°gina
            if (yPosition > 250) {
                pdf.addPage();
                yPosition = 280;
            } else {
                yPosition = 280;
            }
            
            pdf.setFont("helvetica", "italic");
            pdf.setFontSize(8);
            pdf.setTextColor(128, 128, 128);
            pdf.text("Documento generado autom√°ticamente desde https://ivchampionship.netlify.app", 105, yPosition, { align: "center" });
        }
        
        // Funci√≥n de respaldo para generar un PDF simple
        async function downloadSimplePDF() {
            const statusDiv = document.getElementById('pdfStatus');
            const downloadBtn = document.getElementById('downloadPdfBtn');
            
            try {
                await loadjsPDF();
                
                const pdf = new window.jsPDF();
                
                // T√≠tulo simple
                pdf.setFont("helvetica", "bold");
                pdf.setFontSize(16);
                pdf.text("IV CHAMPIONSHIP MASTER AQUATEN - RESULTADOS", 20, 30);
                
                pdf.setFontSize(12);
                pdf.text("Reporte generado el " + new Date().toLocaleDateString('es-ES'), 20, 45);
                
                // Mensaje simple
                pdf.setFont("helvetica", "normal");
                pdf.setFontSize(10);
                pdf.text("Para obtener los resultados completos, visita:", 20, 70);
                pdf.text("https://ivchampionship.netlify.app", 20, 80);
                
                // Informaci√≥n b√°sica de eventos
                pdf.setFont("helvetica", "bold");
                pdf.text("EVENTOS DEL CAMPEONATO:", 20, 100);
                
                pdf.setFont("helvetica", "normal");
                const events = [
                    "‚Ä¢ 50m Libre",
                    "‚Ä¢ 100m Libre", 
                    "‚Ä¢ 200m Libre",
                    "‚Ä¢ 4x50m Libre Femenino",
                    "‚Ä¢ 4x50m Libre Masculino"
                ];
                
                events.forEach((event, index) => {
                    pdf.text(event, 25, 115 + (index * 10));
                });
                
                pdf.save("Resultados_IV_Championship_Simple.pdf");
                statusDiv.style.display = 'none';
                
            } catch (error) {
                console.error('Error en PDF simple:', error);
                statusDiv.innerHTML = '<p style="color: red;">‚ùå Error generando PDF. Problema con la librer√≠a.</p>';
                setTimeout(() => {
                    statusDiv.style.display = 'none';
                }, 3000);
            } finally {
                downloadBtn.disabled = false;
                downloadBtn.style.opacity = '1';
            }
        }

        // Agregar event listener al bot√≥n
        document.addEventListener('DOMContentLoaded', function() {
            const downloadBtn = document.getElementById('downloadPdfBtn');
            if (downloadBtn) {
                // Intentar primero el PDF completo, si falla usar el simple
                downloadBtn.addEventListener('click', async function() {
                    try {
                        await downloadResultsPDF();
                    } catch (error) {
                        console.log('PDF completo fall√≥, intentando versi√≥n simple...');
                        await downloadSimplePDF();
                    }
                });
            }
        });
    </script>
</body>
</html>
